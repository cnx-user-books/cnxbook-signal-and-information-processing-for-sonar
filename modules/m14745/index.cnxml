<document xmlns="http://cnx.rice.edu/cnxml" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:md="http://cnx.rice.edu/mdml">
  <title>Properties of Active Sonar Matched Filtering</title>
  <metadata><md:content-id>undefined</md:content-id><md:title/><md:uuid>0c735f83-2d0a-40dd-9493-88456862c7bf</md:uuid>
</metadata>
  <content>
    <para id="id11719259">Properties of Active Sonar Matched Filtering</para>
    <section id="id-891318991393">
      <title>Introduction</title>
      <para id="id6496768">Matched filters are used extensively in coherent active sonar. The output of a matched filter is used for detection, classification and localization. This document develops some properties of matched filters, including the SNR response in ambient noise and the response to reverberation.</para>
      <para id="id10265290">In a matched filter for active sonar, we are integrating the echo plus interference times the echo’s replica. When an echo passes through the matched filter, we are cross-correlating the echo with a scaled version of the echo, so that the output is a scaled version of the auto-correlation of the echo corrupted by noise. The autocorrelation of the echo has a peak in time whose duration is approximately the inverse of the echo’s bandwidth. </para>
      <para id="id9522365">For some waveforms (such as the Sinusoidal Frequency Modulation pulse) the autocorrelation function will have multiple peaks, termed ‘fingers’, due to the periodic structure of the pulse. Each autocorrelation finger has a time width approximately equal to the signal’s bandwidth.</para>
      <section id="id-0905984114374">
        <title>Continuous Time Matched Filter</title>
        <para id="id11413771">The echo is written as</para>
        <para id="id11236945"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>e</m:mi><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:msqrt><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub></m:msqrt></m:mrow><m:mi>r</m:mi><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{e \( t \) = sqrt {E rSub { size 8{R} } } r \( t \) } {}</m:annotation></m:semantics></m:math>, where 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mrow><m:munderover><m:mo stretchy="false">∫</m:mo><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle><m:mstyle fontsize="8pt"><m:mrow><m:mi>T</m:mi></m:mrow></m:mstyle></m:munderover><m:mrow><m:msup><m:mi>r</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>2</m:mn></m:mrow></m:mstyle></m:msup><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>dt</m:mtext></m:mrow></m:mstyle><m:mo stretchy="false">=</m:mo><m:mn>1</m:mn></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ Int cSub { size 8{0} }  cSup { size 8{T} }  {r rSup { size 8{2} }  \( t \) }  ital "dt"=1} {}</m:annotation></m:semantics></m:math></para>
        <para id="id11651725">This implies that the echo energy 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:munderover><m:mo stretchy="false">∫</m:mo><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle><m:mstyle fontsize="8pt"><m:mrow><m:mi>T</m:mi></m:mrow></m:mstyle></m:munderover><m:mrow><m:msup><m:mi>e</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>2</m:mn></m:mrow></m:mstyle></m:msup><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mo stretchy="false">)</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:mtext>dt</m:mtext></m:mrow></m:mstyle></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ Int cSub { size 8{0} }  cSup { size 8{T} }  {e rSup { size 8{2} }  \( t \)  ital "dt"} } {}</m:annotation></m:semantics></m:math>is 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{E rSub { size 8{R} } } {}</m:annotation></m:semantics></m:math>, measured in Pascal^2-seconds.</para>
        <para id="id12137176">We can write the matched filter operation in continuous time as</para>
        <para id="id7994389">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>t</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>t</m:mi>
                                  <m:mo stretchy="false">+</m:mo>
                                  <m:mi>T</m:mi>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:mi>y</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>σ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>r</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>σ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>t</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi fontstyle="italic">dσ</m:mi>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t \) = Int cSub { size 8{t} }  cSup { size 8{t+T} }  {y \( σ \) r \( σ - t \) dσ} } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10103664"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>y</m:mi><m:mo stretchy="false">(</m:mo><m:mi>σ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{y \( σ \) } {}</m:annotation></m:semantics></m:math>is the receiver time series. In response to a target echo that arrives at 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>T</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>D</m:mi></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{T rSub { size 8{D} } } {}</m:annotation></m:semantics></m:math>seconds and without noise or reverberation, the receiver output is
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>y</m:mi><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:mi>e</m:mi></m:mrow><m:mo stretchy="false">(</m:mo><m:mrow><m:mi>t</m:mi><m:mo stretchy="false">−</m:mo><m:msub><m:mi>T</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>D</m:mi></m:mrow></m:mstyle></m:msub></m:mrow><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{y \( t \) =e \( t - T rSub { size 8{D} }  \) } {}</m:annotation></m:semantics></m:math>. The output of the matched filter becomes: </para>
        <para id="id9722540">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mrow>
                        <m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mo stretchy="false">=</m:mo>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∫</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mi>t</m:mi>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi>t</m:mi>
                                    <m:mo stretchy="false">+</m:mo>
                                    <m:mi>T</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:mi>e</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>σ</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:msub>
                                  <m:mi>T</m:mi>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mi>D</m:mi>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msub>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi>r</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>σ</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>t</m:mi>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi fontstyle="italic">dσ</m:mi>
                            </m:mrow>
                          </m:mrow>
                        </m:mrow>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msqrt>
                          <m:msub>
                            <m:mi>E</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:msqrt>
                      </m:mrow>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>t</m:mi>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mi>t</m:mi>
                                <m:mo stretchy="false">+</m:mo>
                                <m:mi>T</m:mi>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>σ</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:msub>
                              <m:mi>T</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mi>D</m:mi>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>σ</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>t</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi fontstyle="italic">dσ</m:mi>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t \) = Int cSub { size 8{t} }  cSup { size 8{t+T} }  {e \( σ - T rSub { size 8{D} }  \) r \( σ - t \) dσ} = sqrt {E rSub { size 8{R} } }  Int cSub { size 8{t} }  cSup { size 8{t+T} }  {r \( σ - T rSub { size 8{D} }  \) r \( σ - t \) dσ} } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11894588">Hence 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>m</m:mi><m:mo stretchy="false">(</m:mo><m:msub><m:mi>T</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>D</m:mi></m:mrow></m:mstyle></m:msub><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:msqrt><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub></m:msqrt></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{m \( T rSub { size 8{D} }  \) = sqrt {E rSub { size 8{R} } } } {}</m:annotation></m:semantics></m:math>. The peak power output of the matched filter, 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msup><m:mi>m</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>2</m:mn></m:mrow></m:mstyle></m:msup><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{m rSup { size 8{2} }  \( t \) } {}</m:annotation></m:semantics></m:math>, in response to a echo is 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{E rSub { size 8{R} } } {}</m:annotation></m:semantics></m:math>.</para>
        <para id="id10592643">We determine the matched filter response to noise next. Assume the input noise is white with variance 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>:</para>
        <para id="id11518566">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>E</m:mi>
                      <m:mrow>
                        <m:mfenced open="{" close="}">
                          <m:mrow>
                            <m:mi>n</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>t</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>n</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>s</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                        </m:mfenced>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mstyle fontstyle="italic">
                          <m:mrow>
                            <m:msub>
                              <m:mtext>AN</m:mtext>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mn>0</m:mn>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                          </m:mrow>
                        </m:mstyle>
                      </m:mrow>
                      <m:mi>δ</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mrow>
                        <m:mi>t</m:mi>
                        <m:mo stretchy="false">−</m:mo>
                        <m:mi>s</m:mi>
                      </m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace n \( t \) n \( s \)  right rbrace = ital "AN" rSub { size 8{0} } δ \( t - s \) } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10492534">Note that the delta function has units of inverse seconds, and therefore 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>has units of Pascals^2/Hz, equivalent to a spectral density. From the definition of stationary random process autocorrelations and power spectral density, we know that the Fourier transform of the autocorrelation is the spectral density function for the random process. The Fourier transform of covariance becomes
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mrow><m:mo stretchy="false">∫</m:mo><m:msup><m:mi>e</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi fontstyle="italic">j2πfτ</m:mi></m:mrow></m:mstyle></m:msup></m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mi>δ</m:mi><m:mo stretchy="false">(</m:mo><m:mi>τ</m:mi><m:mo stretchy="false">)</m:mo><m:mrow><m:mi fontstyle="italic">dτ</m:mi><m:mo stretchy="false">=</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ Int {e rSup { size 8{j2πfτ} } }  ital "AN" rSub { size 8{0} } δ \( τ \) dτ= ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>, which is the spectral density of the noise.</para>
        <para id="id11545772">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mrow>
                  <m:mtable>
                    <m:mtr>
                      <m:mrow>
                        <m:mstyle fontsize="12pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mi>E</m:mi>
                              <m:mrow>
                                <m:mfenced open="{" close="}">
                                  <m:mrow>
                                    <m:mi>m</m:mi>
                                    <m:mo stretchy="false">(</m:mo>
                                    <m:mi>t</m:mi>
                                    <m:mo stretchy="false">)</m:mo>
                                    <m:mi>m</m:mi>
                                    <m:mo stretchy="false">(</m:mo>
                                    <m:mi>s</m:mi>
                                    <m:mo stretchy="false">)</m:mo>
                                  </m:mrow>
                                </m:mfenced>
                                <m:mo stretchy="false">=</m:mo>
                                <m:mi>E</m:mi>
                              </m:mrow>
                              <m:mrow>
                                <m:mfenced open="{" close="}">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:munderover>
                                        <m:mo stretchy="false">∫</m:mo>
                                        <m:mstyle fontsize="8pt">
                                          <m:mrow>
                                            <m:mi>t</m:mi>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="8pt">
                                          <m:mrow>
                                            <m:mrow>
                                              <m:mi>t</m:mi>
                                              <m:mo stretchy="false">+</m:mo>
                                              <m:mi>T</m:mi>
                                            </m:mrow>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:munderover>
                                      <m:mrow>
                                        <m:mi>n</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mi>σ</m:mi>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mi>r</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:mi>σ</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:mi>t</m:mi>
                                        </m:mrow>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mi fontstyle="italic">dσ</m:mi>
                                      </m:mrow>
                                    </m:mrow>
                                    <m:mrow>
                                      <m:munderover>
                                        <m:mo stretchy="false">∫</m:mo>
                                        <m:mstyle fontsize="8pt">
                                          <m:mrow>
                                            <m:mi>t</m:mi>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="8pt">
                                          <m:mrow>
                                            <m:mrow>
                                              <m:mi>t</m:mi>
                                              <m:mo stretchy="false">+</m:mo>
                                              <m:mi>T</m:mi>
                                            </m:mrow>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:munderover>
                                      <m:mrow>
                                        <m:mi>n</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mi>β</m:mi>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mi>r</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:mi>β</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:mi>t</m:mi>
                                        </m:mrow>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mi fontstyle="italic">dβ</m:mi>
                                      </m:mrow>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mfenced>
                                <m:mo stretchy="false">=</m:mo>
                                <m:mrow/>
                              </m:mrow>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                        <m:mrow/>
                      </m:mrow>
                    </m:mtr>
                    <m:mtr>
                      <m:mrow>
                        <m:mstyle fontstyle="italic">
                          <m:mrow>
                            <m:msub>
                              <m:mtext>AN</m:mtext>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mn>0</m:mn>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                          </m:mrow>
                        </m:mstyle>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>t</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>t</m:mi>
                                  <m:mo stretchy="false">+</m:mo>
                                  <m:mi>T</m:mi>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow/>
                        </m:mrow>
                        <m:mrow>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∫</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mi>t</m:mi>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi>t</m:mi>
                                    <m:mo stretchy="false">+</m:mo>
                                    <m:mi>T</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:mi>δ</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>σ</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>β</m:mi>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi>r</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>σ</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>t</m:mi>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi>r</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>β</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>t</m:mi>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi fontstyle="italic">dσdβ</m:mi>
                            </m:mrow>
                          </m:mrow>
                          <m:mo stretchy="false">=</m:mo>
                          <m:mstyle fontstyle="italic">
                            <m:mrow>
                              <m:msub>
                                <m:mtext>AN</m:mtext>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mn>0</m:mn>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msub>
                            </m:mrow>
                          </m:mstyle>
                        </m:mrow>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>t</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>t</m:mi>
                                  <m:mo stretchy="false">+</m:mo>
                                  <m:mi>T</m:mi>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:msup>
                              <m:mi>r</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mn>2</m:mn>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>σ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>t</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mrow>
                              <m:mi fontstyle="italic">dσ</m:mi>
                              <m:mo stretchy="false">=</m:mo>
                              <m:mrow/>
                            </m:mrow>
                          </m:mrow>
                        </m:mrow>
                        <m:mstyle fontstyle="italic">
                          <m:mrow>
                            <m:msub>
                              <m:mtext>AN</m:mtext>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mn>0</m:mn>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                          </m:mrow>
                        </m:mstyle>
                        <m:mrow/>
                      </m:mrow>
                    </m:mtr>
                  </m:mtable>
                  <m:mrow/>
                </m:mrow>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0">alignl { stack {
 size 12{E left lbrace m \( t \) m \( s \)  right rbrace =E left lbrace  Int cSub { size 8{t} }  cSup { size 8{t+T} }  {n \( σ \) r \( σ - t \) dσ}  Int cSub { size 8{t} }  cSup { size 8{t+T} }  {n \( β \) r \( β - t \) dβ}  right rbrace ={}}  {} # 
 ital "AN" rSub { size 8{0} }  Int cSub { size 8{t} }  cSup { size 8{t+T} }  {}  Int cSub { size 8{t} }  cSup { size 8{t+T} }  {δ \( σ - β \) r \( σ - t \) r \( β - t \) dσdβ} = ital "AN" rSub { size 8{0} }  Int cSub { size 8{t} }  cSup { size 8{t+T} }  {r rSup { size 8{2} }  \( σ - t \) dσ={}}  ital "AN" rSub { size 8{0} }  {} 
} } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10749074">Thus, the noise power response of a matched filter is the input spectral density, 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>. </para>
        <para id="id10746937">We conclude that the signal to noise ratio (SNR) at the output of a matched filter is the ratio of the echo energy to the noise spectral density, 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">/</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{E rSub { size 8{R} } / ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>. This assumes that the noise is white, e.g. a flat spectral density at the input to the matched filter. This is a general result, independent of the signal waveform details, except for its energy
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{E rSub { size 8{R} } } {}</m:annotation></m:semantics></m:math>.</para>
      </section>
      <section id="id-356124912436">
        <title>Discrete Time Matched Filters</title>
        <para id="id8134297">Discrete time filters have nearly the same properties as continuous time filters. In discrete time, we assume an echo of 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>e</m:mi><m:mo stretchy="false">(</m:mo><m:mi>k</m:mi><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:msqrt><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub></m:msqrt></m:mrow><m:mi>r</m:mi><m:mo stretchy="false">(</m:mo><m:mi>k</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{e \( k \) = sqrt {E rSub { size 8{R} } } r \( k \) } {}</m:annotation></m:semantics></m:math>, with 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mrow><m:munderover><m:mo stretchy="false">∑</m:mo><m:mstyle fontsize="8pt"><m:mrow><m:mrow><m:mi>k</m:mi><m:mo stretchy="false">=</m:mo><m:mn>1</m:mn></m:mrow></m:mrow></m:mstyle><m:mstyle fontsize="8pt"><m:mrow><m:mi>T</m:mi></m:mrow></m:mstyle></m:munderover><m:mrow><m:msup><m:mi>r</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>2</m:mn></m:mrow></m:mstyle></m:msup><m:mo stretchy="false">(</m:mo><m:mi>k</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow><m:mo stretchy="false">=</m:mo><m:mn>1</m:mn></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ Sum cSub { size 8{k=1} }  cSup { size 8{T} }  {r rSup { size 8{2} }  \( k \) } =1} {}</m:annotation></m:semantics></m:math>. The discrete matched filter output to the input y(k) is given by:</para>
        <para id="id12157436">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>k</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∑</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>l</m:mi>
                                  <m:mo stretchy="false">=</m:mo>
                                  <m:mi>k</m:mi>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi>k</m:mi>
                                    <m:mo stretchy="false">+</m:mo>
                                    <m:mi>T</m:mi>
                                  </m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mn>1</m:mn>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:mi>y</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>l</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>r</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mrow>
                                <m:mi>l</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>k</m:mi>
                              </m:mrow>
                              <m:mo stretchy="false">+</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( k \) = Sum cSub { size 8{l=k} }  cSup { size 8{k+T - 1} }  {y \( l \) r \( l - k+1 \) } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11746691">In response to the echo, 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>y</m:mi><m:mo stretchy="false">(</m:mo><m:mi>k</m:mi><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:mi>e</m:mi></m:mrow><m:mo stretchy="false">(</m:mo><m:mrow><m:mi>k</m:mi><m:mo stretchy="false">−</m:mo><m:msub><m:mi>T</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>D</m:mi></m:mrow></m:mstyle></m:msub></m:mrow><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{y \( k \) =e \( k - T rSub { size 8{D} }  \) } {}</m:annotation></m:semantics></m:math>the output of the discrete time matched filter is </para>
        <para id="id11894324">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>k</m:mi>
                      <m:mrow>
                        <m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mo stretchy="false">=</m:mo>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∑</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi>l</m:mi>
                                    <m:mo stretchy="false">=</m:mo>
                                    <m:mi>k</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mi>k</m:mi>
                                      <m:mo stretchy="false">+</m:mo>
                                      <m:mi>T</m:mi>
                                    </m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mn>1</m:mn>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:mi>e</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>l</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:msub>
                                  <m:mi>T</m:mi>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mi>D</m:mi>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msub>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi>r</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>l</m:mi>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mi>k</m:mi>
                                </m:mrow>
                                <m:mo stretchy="false">+</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                            </m:mrow>
                          </m:mrow>
                        </m:mrow>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msqrt>
                          <m:msub>
                            <m:mi>E</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:msqrt>
                      </m:mrow>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∑</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mi>l</m:mi>
                                <m:mo stretchy="false">=</m:mo>
                                <m:mi>k</m:mi>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>k</m:mi>
                                  <m:mo stretchy="false">+</m:mo>
                                  <m:mi>T</m:mi>
                                </m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>l</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:msub>
                              <m:mi>T</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mi>D</m:mi>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mrow>
                              <m:mi>l</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>k</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">+</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( k \) = Sum cSub { size 8{l=k} }  cSup { size 8{k+T - 1} }  {e \( l - T rSub { size 8{D} }  \) r \( l - k+1 \) } = sqrt {E rSub { size 8{R} } }  Sum cSub { size 8{l=k} }  cSup { size 8{k+T - 1} }  {r \( l - T rSub { size 8{D} }  \) r \( l - k+1 \) } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id7345611">Hence 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>m</m:mi><m:mo stretchy="false">(</m:mo><m:mrow><m:msub><m:mi>T</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>D</m:mi></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">−</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:msqrt><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub></m:msqrt></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{m \( T rSub { size 8{D} }  - 1 \) = sqrt {E rSub { size 8{R} } } } {}</m:annotation></m:semantics></m:math>. The peak power output of the matched filter, 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msup><m:mi>m</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>2</m:mn></m:mrow></m:mstyle></m:msup><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{m rSup { size 8{2} }  \( t \) } {}</m:annotation></m:semantics></m:math>, in response to a echo is 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{E rSub { size 8{R} } } {}</m:annotation></m:semantics></m:math>.</para>
        <para id="id11132058">We determine the discrete matched filter response to noise next. Assume the input noise is sampled white with variance 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>:</para>
        <para id="id12106055">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>E</m:mi>
                      <m:mrow>
                        <m:mfenced open="{" close="}">
                          <m:mrow>
                            <m:mi>n</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>k</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>n</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>l</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                        </m:mfenced>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mstyle fontstyle="italic">
                          <m:mrow>
                            <m:msub>
                              <m:mtext>AN</m:mtext>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mn>0</m:mn>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                          </m:mrow>
                        </m:mstyle>
                      </m:mrow>
                      <m:msub>
                        <m:mi>δ</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mstyle fontstyle="italic">
                              <m:mrow>
                                <m:mtext>kl</m:mtext>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace n \( k \) n \( l \)  right rbrace = ital "AN" rSub { size 8{0} } δ rSub { size 8{ ital "kl"} } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id12115723">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mrow>
                  <m:mtable>
                    <m:mtr>
                      <m:mrow>
                        <m:mstyle fontsize="12pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mi>E</m:mi>
                              <m:mrow>
                                <m:mfenced open="{" close="}">
                                  <m:mrow>
                                    <m:mi>m</m:mi>
                                    <m:mo stretchy="false">(</m:mo>
                                    <m:mi>k</m:mi>
                                    <m:mo stretchy="false">)</m:mo>
                                    <m:mi>m</m:mi>
                                    <m:mo stretchy="false">(</m:mo>
                                    <m:mi>p</m:mi>
                                    <m:mo stretchy="false">)</m:mo>
                                  </m:mrow>
                                </m:mfenced>
                                <m:mo stretchy="false">=</m:mo>
                                <m:mi>E</m:mi>
                              </m:mrow>
                              <m:mrow>
                                <m:mfenced open="{" close="}">
                                  <m:mrow>
                                    <m:munderover>
                                      <m:mo stretchy="false">∑</m:mo>
                                      <m:mstyle fontsize="8pt">
                                        <m:mrow>
                                          <m:mrow>
                                            <m:mi>l</m:mi>
                                            <m:mo stretchy="false">=</m:mo>
                                            <m:mi>k</m:mi>
                                          </m:mrow>
                                        </m:mrow>
                                      </m:mstyle>
                                      <m:mstyle fontsize="8pt">
                                        <m:mrow>
                                          <m:mrow>
                                            <m:mrow>
                                              <m:mi>k</m:mi>
                                              <m:mo stretchy="false">+</m:mo>
                                              <m:mi>T</m:mi>
                                            </m:mrow>
                                            <m:mo stretchy="false">−</m:mo>
                                            <m:mn>1</m:mn>
                                          </m:mrow>
                                        </m:mrow>
                                      </m:mstyle>
                                    </m:munderover>
                                    <m:mrow>
                                      <m:mi>n</m:mi>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mi>l</m:mi>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:mi>r</m:mi>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mrow>
                                        <m:mrow>
                                          <m:mi>l</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:mi>k</m:mi>
                                        </m:mrow>
                                        <m:mo stretchy="false">+</m:mo>
                                        <m:mn>1</m:mn>
                                      </m:mrow>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:mrow>
                                        <m:munderover>
                                          <m:mo stretchy="false">∑</m:mo>
                                          <m:mstyle fontsize="8pt">
                                            <m:mrow>
                                              <m:mrow>
                                                <m:mi>i</m:mi>
                                                <m:mo stretchy="false">=</m:mo>
                                                <m:mi>p</m:mi>
                                              </m:mrow>
                                            </m:mrow>
                                          </m:mstyle>
                                          <m:mstyle fontsize="8pt">
                                            <m:mrow>
                                              <m:mrow>
                                                <m:mrow>
                                                  <m:mi>p</m:mi>
                                                  <m:mo stretchy="false">+</m:mo>
                                                  <m:mi>T</m:mi>
                                                </m:mrow>
                                                <m:mo stretchy="false">−</m:mo>
                                                <m:mn>1</m:mn>
                                              </m:mrow>
                                            </m:mrow>
                                          </m:mstyle>
                                        </m:munderover>
                                        <m:mrow>
                                          <m:mi>n</m:mi>
                                          <m:mo stretchy="false">(</m:mo>
                                          <m:mi>i</m:mi>
                                          <m:mo stretchy="false">)</m:mo>
                                          <m:mi>r</m:mi>
                                          <m:mo stretchy="false">(</m:mo>
                                          <m:mrow>
                                            <m:mrow>
                                              <m:mi>i</m:mi>
                                              <m:mo stretchy="false">−</m:mo>
                                              <m:mi>p</m:mi>
                                            </m:mrow>
                                            <m:mo stretchy="false">+</m:mo>
                                            <m:mn>1</m:mn>
                                          </m:mrow>
                                          <m:mo stretchy="false">)</m:mo>
                                        </m:mrow>
                                      </m:mrow>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mfenced>
                                <m:mo stretchy="false">=</m:mo>
                                <m:mrow/>
                              </m:mrow>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                        <m:mrow/>
                      </m:mrow>
                    </m:mtr>
                    <m:mtr>
                      <m:mrow>
                        <m:mstyle fontstyle="italic">
                          <m:mrow>
                            <m:msub>
                              <m:mtext>AN</m:mtext>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mn>0</m:mn>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                          </m:mrow>
                        </m:mstyle>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∑</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>l</m:mi>
                                  <m:mo stretchy="false">=</m:mo>
                                  <m:mi>k</m:mi>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi>k</m:mi>
                                    <m:mo stretchy="false">+</m:mo>
                                    <m:mi>T</m:mi>
                                  </m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mn>1</m:mn>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∑</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi>i</m:mi>
                                    <m:mo stretchy="false">=</m:mo>
                                    <m:mi>p</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mi>p</m:mi>
                                      <m:mo stretchy="false">+</m:mo>
                                      <m:mi>T</m:mi>
                                    </m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mn>1</m:mn>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow/>
                          </m:mrow>
                        </m:mrow>
                        <m:msub>
                          <m:mi>δ</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mstyle fontstyle="italic">
                                <m:mrow>
                                  <m:mtext>li</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                        <m:mi>r</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mrow>
                            <m:mi>l</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>k</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">+</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>r</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mrow>
                            <m:mi>i</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>p</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">+</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                        <m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mo stretchy="false">=</m:mo>
                          <m:mstyle fontstyle="italic">
                            <m:mrow>
                              <m:msub>
                                <m:mtext>AN</m:mtext>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mn>0</m:mn>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msub>
                            </m:mrow>
                          </m:mstyle>
                        </m:mrow>
                        <m:mrow>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∑</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi>l</m:mi>
                                    <m:mo stretchy="false">=</m:mo>
                                    <m:mi>k</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mi>k</m:mi>
                                      <m:mo stretchy="false">+</m:mo>
                                      <m:mi>T</m:mi>
                                    </m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mn>1</m:mn>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:msup>
                                <m:mi>r</m:mi>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mn>2</m:mn>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msup>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>l</m:mi>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mi>k</m:mi>
                                </m:mrow>
                                <m:mo stretchy="false">+</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                            </m:mrow>
                          </m:mrow>
                          <m:mo stretchy="false">=</m:mo>
                          <m:mstyle fontstyle="italic">
                            <m:mrow>
                              <m:msub>
                                <m:mtext>AN</m:mtext>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mn>0</m:mn>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msub>
                            </m:mrow>
                          </m:mstyle>
                        </m:mrow>
                        <m:mrow/>
                      </m:mrow>
                    </m:mtr>
                  </m:mtable>
                  <m:mrow/>
                </m:mrow>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0">alignl { stack {
 size 12{E left lbrace m \( k \) m \( p \)  right rbrace =E left lbrace  Sum cSub { size 8{l=k} }  cSup { size 8{k+T - 1} }  {n \( l \) r \( l - k+1 \)  Sum cSub { size 8{i=p} }  cSup { size 8{p+T - 1} }  {n \( i \) r \( i - p+1 \) } }  right rbrace ={}}  {} # 
 ital "AN" rSub { size 8{0} }  Sum cSub { size 8{l=k} }  cSup { size 8{k+T - 1} }  { Sum cSub { size 8{i=p} }  cSup { size 8{p+T - 1} }  {} } δ rSub { size 8{ ital "li"} } r \( l - k+1 \) r \( i - p+1 \) = ital "AN" rSub { size 8{0} }  Sum cSub { size 8{l=k} }  cSup { size 8{k+T - 1} }  {r rSup { size 8{2} }  \( l - k+1 \) } = ital "AN" rSub { size 8{0} }  {} 
} } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10486051">Thus, the signal to noise ratio at the output of a discrete time matched filter is
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">/</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{E rSub { size 8{R} } / ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>.</para>
        <para id="id8516366">The matched filter compresses the echo signal to a pulse (or a series of pulses for waveforms such as SFM) with time width equal approximately to its inverse bandwidth, 1/BW. </para>
      </section>
    </section>
    <section id="id-940013228456">
      <title>Matched Filter Response to Reverberation</title>
      <para id="id7703176">One model for reverberation assumes that the reverberation comes from distributed discrete scatterers, with density 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>A</m:mi><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{A \( u \) } {}</m:annotation></m:semantics></m:math>. </para>
      <para id="id9195573"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>y</m:mi><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:msqrt><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>T</m:mi></m:mrow></m:mstyle></m:msub></m:msqrt></m:mrow><m:mrow><m:munderover><m:mo stretchy="false">∫</m:mo><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle><m:mstyle fontsize="8pt"><m:mrow><m:mo stretchy="false">∞</m:mo></m:mrow></m:mstyle></m:munderover><m:mrow><m:mi>A</m:mi><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo><m:mi>Γ</m:mi><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo><m:mi>r</m:mi><m:mo stretchy="false">(</m:mo><m:mrow><m:mi>t</m:mi><m:mo stretchy="false">−</m:mo><m:mi>τ</m:mi></m:mrow><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">)</m:mo><m:mi>d</m:mi></m:mrow></m:mrow><m:mi>u</m:mi></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{y \( t \) = sqrt {E rSub { size 8{T} } }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {A \( u \) Γ \( u \) r \( t - τ \( u \)  \) d} u} {}</m:annotation></m:semantics></m:math>,</para>
      <para id="id10745148"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>A</m:mi><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{A \( u \) } {}</m:annotation></m:semantics></m:math> is considered a random, spatial process that models the amplitude of the scattering that occurs at range u back to the receiver. We are assuming that the receiver has significant aperture, and that y(t) is the receiver response at the output of a beamformer. In this case, scattering is occurring from the patch of the ocean bottom or surface that lies at range u and within the receiver beamwidth in azimuth and elevation. Each patch of the bottom or surface will arrive at the receiver at a different time. 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>Γ</m:mi><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Γ \( u \) } {}</m:annotation></m:semantics></m:math>is the transmission loss from the source to the scattering range (u) and back to the receiver. 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>τ</m:mi><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ \( u \) } {}</m:annotation></m:semantics></m:math>is the total travel time from source to scatterer to receiver. As one can see, the reverberation is made up of many time delayed and amplitude scaled replicas of the transmitted waveform.</para>
      <para id="id10638430">The matched filter response to the reverberation is</para>
      <para id="id10638435">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mrow>
                <m:mtable>
                  <m:mtr>
                    <m:mrow>
                      <m:mstyle fontsize="12pt">
                        <m:mrow>
                          <m:mrow>
                            <m:msub>
                              <m:mi>m</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mi>R</m:mi>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>t</m:mi>
                            <m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mo stretchy="false">=</m:mo>
                              <m:mrow>
                                <m:msubsup>
                                  <m:mo stretchy="false">∫</m:mo>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mi>t</m:mi>
                                    </m:mrow>
                                  </m:mstyle>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mrow>
                                        <m:mi>t</m:mi>
                                        <m:mo stretchy="false">+</m:mo>
                                        <m:mi>T</m:mi>
                                      </m:mrow>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msubsup>
                                <m:mrow>
                                  <m:mi>r</m:mi>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:mrow>
                                    <m:mi>σ</m:mi>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mi>t</m:mi>
                                  </m:mrow>
                                  <m:mo stretchy="false">)</m:mo>
                                  <m:msqrt>
                                    <m:msub>
                                      <m:mi>E</m:mi>
                                      <m:mstyle fontsize="8pt">
                                        <m:mrow>
                                          <m:mi>T</m:mi>
                                        </m:mrow>
                                      </m:mstyle>
                                    </m:msub>
                                  </m:msqrt>
                                  <m:mrow>
                                    <m:munderover>
                                      <m:mo stretchy="false">∫</m:mo>
                                      <m:mstyle fontsize="8pt">
                                        <m:mrow>
                                          <m:mn>0</m:mn>
                                        </m:mrow>
                                      </m:mstyle>
                                      <m:mstyle fontsize="8pt">
                                        <m:mrow>
                                          <m:mo stretchy="false">∞</m:mo>
                                        </m:mrow>
                                      </m:mstyle>
                                    </m:munderover>
                                    <m:mrow>
                                      <m:mi>A</m:mi>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mi>u</m:mi>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:mi>Γ</m:mi>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mi>u</m:mi>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:mi>r</m:mi>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mrow>
                                        <m:mi>σ</m:mi>
                                        <m:mo stretchy="false">−</m:mo>
                                        <m:mi>τ</m:mi>
                                      </m:mrow>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mi>u</m:mi>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:mi>d</m:mi>
                                    </m:mrow>
                                  </m:mrow>
                                  <m:mi>u</m:mi>
                                </m:mrow>
                              </m:mrow>
                            </m:mrow>
                            <m:mrow>
                              <m:mi fontstyle="italic">dσ</m:mi>
                              <m:mo stretchy="false">=</m:mo>
                              <m:mrow/>
                            </m:mrow>
                          </m:mrow>
                        </m:mrow>
                      </m:mstyle>
                      <m:mrow/>
                    </m:mrow>
                  </m:mtr>
                  <m:mtr>
                    <m:mrow>
                      <m:msqrt>
                        <m:msub>
                          <m:mi>E</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:msqrt>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>0</m:mn>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:mi>A</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mrow>
                            <m:msubsup>
                              <m:mo stretchy="false">∫</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mi>t</m:mi>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi>t</m:mi>
                                    <m:mo stretchy="false">+</m:mo>
                                    <m:mi>T</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:msubsup>
                            <m:mrow>
                              <m:mi>r</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>σ</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>τ</m:mi>
                              </m:mrow>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mi>u</m:mi>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi>r</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>σ</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>t</m:mi>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                            </m:mrow>
                          </m:mrow>
                          <m:mi fontstyle="italic">dσd</m:mi>
                        </m:mrow>
                      </m:mrow>
                      <m:mi>u</m:mi>
                      <m:mrow/>
                    </m:mrow>
                  </m:mtr>
                </m:mtable>
                <m:mrow/>
              </m:mrow>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0">alignl { stack {
 size 12{m rSub { size 8{R} }  \( t \) = Int rSub { size 8{t} }  rSup { size 8{t+T} }  {r \( σ - t \)  sqrt {E rSub { size 8{T} } }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {A \( u \) Γ \( u \) r \( σ - τ \( u \)  \) d} u} dσ={}}  {} # 
 sqrt {E rSub { size 8{T} } }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {A \( u \) Γ \( u \)  Int rSub { size 8{t} }  rSup { size 8{t+T} }  {r \( σ - τ \( u \)  \) r \( σ - t \) } dσd} u {} 
} } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10749027">We define the transmitted waveform autocorrelation function as</para>
      <para id="id10575558">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>χ</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>τ</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mrow>
                        <m:msubsup>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>0</m:mn>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msubsup>
                        <m:mrow>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>t</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>τ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>r</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo stretchy="false">)</m:mo>
                    <m:mstyle fontstyle="italic">
                      <m:mrow>
                        <m:mtext>dt</m:mtext>
                      </m:mrow>
                    </m:mstyle>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{χ \( τ \) = Int rSub { size 8{0} }  rSup { size 8{T} }  {r \( t - τ \) } r \( t \)  ital "dt"} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10996630">Recall, that by definition, 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>χ</m:mi><m:mo stretchy="false">(</m:mo><m:mn>0</m:mn><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:mrow><m:msubsup><m:mo stretchy="false">∫</m:mo><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle><m:mstyle fontsize="8pt"><m:mrow><m:mi>T</m:mi></m:mrow></m:mstyle></m:msubsup><m:mrow><m:msup><m:mi>r</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>2</m:mn></m:mrow></m:mstyle></m:msup><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mrow><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>dt</m:mtext></m:mrow></m:mstyle><m:mo stretchy="false">=</m:mo><m:mn>1</m:mn></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{χ \( 0 \) = Int rSub { size 8{0} }  rSup { size 8{T} }  {r rSup { size 8{2} }  \( t \) }  ital "dt"=1} {}</m:annotation></m:semantics></m:math>. In more general terms, we define the transmitted wideband signal ambiguity function as</para>
      <para id="id8758042">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:msub>
                      <m:mi>χ</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mstyle fontstyle="italic">
                            <m:mrow>
                              <m:mtext>WB</m:mtext>
                            </m:mrow>
                          </m:mstyle>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>τ</m:mi>
                    <m:mi>,</m:mi>
                    <m:mi>η</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msqrt>
                        <m:mi>η</m:mi>
                      </m:msqrt>
                    </m:mrow>
                    <m:mrow>
                      <m:msubsup>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:msubsup>
                      <m:mrow>
                        <m:msup>
                          <m:mi>r</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow/>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>η</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>t</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>τ</m:mi>
                        </m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">)</m:mo>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>r</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo stretchy="false">)</m:mo>
                    <m:mstyle fontstyle="italic">
                      <m:mrow>
                        <m:mtext>dt</m:mtext>
                      </m:mrow>
                    </m:mstyle>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{χ rSub { size 8{ ital "WB"} }  \( τ,η \) = sqrt {η}  Int rSub { size 8{ -  infinity } }  rSup { size 8{ infinity } }  {r rSup { size 8{*} }  \( η \( t - τ \)  \) } r \( t \)  ital "dt"} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id9192752">Note: Some authors define the ambiguity function as the magnitude squared value of this definition. Other authors choose different normalizations or the sign (-/+) on the delay term 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>τ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ} {}</m:annotation></m:semantics></m:math>. </para>
      <para id="id11121251">In the wideband signal ambiguity function, the Doppler effect is represented by the scaling factor 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>η</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{η} {}</m:annotation></m:semantics></m:math>. In narrowband cases, the Doppler effect is represented by a frequency shift, 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>φ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{φ} {}</m:annotation></m:semantics></m:math>. For a monostatic sonar the frequency shift is given by 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mrow><m:mi>φ</m:mi><m:mo stretchy="false">=</m:mo><m:mn>2</m:mn></m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>v/c</m:mtext></m:mrow></m:mstyle></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{φ=2 ital "v/c"} {}</m:annotation></m:semantics></m:math>, where 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>v</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{v} {}</m:annotation></m:semantics></m:math>is the radial velocity between the scattering object and the sonar system. </para>
      <para id="id10101429">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:msub>
                      <m:mi>χ</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mstyle fontstyle="italic">
                            <m:mrow>
                              <m:mtext>NB</m:mtext>
                            </m:mrow>
                          </m:mstyle>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>τ</m:mi>
                    <m:mi>,</m:mi>
                    <m:mi>φ</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mrow>
                        <m:msubsup>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:msubsup>
                        <m:mrow>
                          <m:msup>
                            <m:mi>r</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow/>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>t</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>τ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>r</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mo stretchy="false">)</m:mo>
                    <m:msup>
                      <m:mi>e</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mrow>
                            <m:mrow>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi fontstyle="italic">j2</m:mi>
                            </m:mrow>
                            <m:mstyle fontstyle="italic">
                              <m:mrow>
                                <m:mtext>πφ</m:mtext>
                              </m:mrow>
                            </m:mstyle>
                            <m:mi>t</m:mi>
                          </m:mrow>
                        </m:mrow>
                      </m:mstyle>
                    </m:msup>
                    <m:mstyle fontstyle="italic">
                      <m:mrow>
                        <m:mtext>dt</m:mtext>
                      </m:mrow>
                    </m:mstyle>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{χ rSub { size 8{ ital "NB"} }  \( τ,φ \) = Int rSub { size 8{ -  infinity } }  rSup { size 8{ infinity } }  {r rSup { size 8{*} }  \( t - τ \) } r \( t \) e rSup { size 8{ - j2 ital "πφ"t} }  ital "dt"} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id9251019">One can show (Weiss) that the narrowband approximation to Doppler is valid if 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mn>2</m:mn><m:mstyle fontstyle="italic"><m:mrow><m:mtext>v/c</m:mtext></m:mrow></m:mstyle><m:mtext>&lt;&lt;</m:mtext><m:mfrac><m:mn>1</m:mn><m:mstyle fontstyle="italic"><m:mrow><m:mtext>BT</m:mtext></m:mrow></m:mstyle></m:mfrac></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{2 ital "v/c""&lt;&lt;" {  {1}  over  { ital "BT"} } } {}</m:annotation></m:semantics></m:math>, where 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>B</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{B} {}</m:annotation></m:semantics></m:math>is the waveform bandwidth and 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>T</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{T} {}</m:annotation></m:semantics></m:math>is the duration. For one hundred (100) Hertz bandwidth waveforms that last for one (1) second, the speed of the target must be much less than 7.5 m/sec, or approximately 15 knots. </para>
      <para id="id11754210">An important invariance property of the narrowband ambiguity function is that </para>
      <para id="id12104636">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mrow>
                      <m:mo stretchy="false">∫</m:mo>
                      <m:msup>
                        <m:mrow>
                          <m:mo stretchy="false">∣</m:mo>
                          <m:mrow>
                            <m:msub>
                              <m:mi>χ</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mstyle fontstyle="italic">
                                    <m:mrow>
                                      <m:mtext>NB</m:mtext>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>τ</m:mi>
                            <m:mi>,</m:mi>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                          <m:mo stretchy="false">∣</m:mo>
                        </m:mrow>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>2</m:mn>
                          </m:mrow>
                        </m:mstyle>
                      </m:msup>
                    </m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>dt</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{ Int { lline χ rSub { size 8{ ital "NB"} }  \( τ,φ \)  rline }  rSup { size 8{2} }  ital "dt"=1} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11160064">Using either definition of the signal ambiguity function we have</para>
      <para id="id11160069">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mrow>
                      <m:msubsup>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>t</m:mi>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mi>t</m:mi>
                              <m:mo stretchy="false">+</m:mo>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                      </m:msubsup>
                      <m:mrow>
                        <m:mi>r</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>σ</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>τ</m:mi>
                        </m:mrow>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>r</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>σ</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>t</m:mi>
                        </m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                      </m:mrow>
                    </m:mrow>
                    <m:mrow>
                      <m:mi fontstyle="italic">dσ</m:mi>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mrow>
                        <m:msubsup>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>0</m:mn>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msubsup>
                        <m:mrow>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:msup>
                              <m:mi>σ</m:mi>
                              <m:mi>'</m:mi>
                            </m:msup>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mo stretchy="false">(</m:mo>
                          </m:mrow>
                          <m:mi>τ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>t</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:msup>
                            <m:mi>σ</m:mi>
                            <m:mi>'</m:mi>
                          </m:msup>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>d</m:mi>
                    <m:mrow>
                      <m:msup>
                        <m:mi>σ</m:mi>
                        <m:mi>'</m:mi>
                      </m:msup>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mi>χ</m:mi>
                    </m:mrow>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>τ</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>u</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">−</m:mo>
                      <m:mi>t</m:mi>
                    </m:mrow>
                    <m:mi>,</m:mi>
                    <m:mn>0</m:mn>
                    <m:mo stretchy="false">)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{ Int rSub { size 8{t} }  rSup { size 8{t+T} }  {r \( σ - τ \( u \)  \) r \( σ - t \) } dσ= Int rSub { size 8{0} }  rSup { size 8{T} }  {r \(  { {σ}} sup { ' } -  \( τ \( u \)  - t \)  \) r \(  { {σ}} sup { ' } \) } d { {σ}} sup { ' }=χ \( τ \( u \)  - t,0 \) } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id12163960">Therefore the matched filter response is</para>
      <para id="id12163965">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:msub>
                      <m:mi>m</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mi>R</m:mi>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msqrt>
                        <m:msub>
                          <m:mi>E</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:msqrt>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:mi>A</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>Γ</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>χ</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>τ</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>t</m:mi>
                        </m:mrow>
                        <m:mi>,</m:mi>
                        <m:mn>0</m:mn>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>d</m:mi>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>u</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{m rSub { size 8{R} }  \( t \) = sqrt {E rSub { size 8{T} } }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {A \( u \) Γ \( u \) χ \( τ \( u \)  - t,0 \) d} u} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11100720">This expression for the matched filter response shows that the amount of reverberation at time t is directly related to the transmitted signal’s autocorrelation and energy source level (ESL). Wide band signals will have narrower autocorrelation peaks, and thus less reverberation amplitude. </para>
      <para id="id9052722">Using the narrowband approximation for Doppler shifts allows efficient implementation of matched filter banks as generalized spectrogram analysis. One treats the replica as a “window function” in place of the more traditional Hanning or Hamming windows. The matched filter for narrowband Doppler shifts is given by:</para>
      <para id="id9756571">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>m</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mi>,</m:mi>
                    <m:mi>φ</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>t</m:mi>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mi>t</m:mi>
                                <m:mo stretchy="false">+</m:mo>
                                <m:mi>T</m:mi>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:mi>y</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>σ</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:msup>
                            <m:mi>r</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow/>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>σ</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>t</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:msup>
                            <m:mi>e</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mi fontstyle="italic">j2</m:mi>
                                  </m:mrow>
                                  <m:mstyle fontstyle="italic">
                                    <m:mrow>
                                      <m:mtext>πφσ</m:mtext>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mi fontstyle="italic">dσ</m:mi>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) = Int cSub { size 8{t} }  cSup { size 8{t+T} }  {y \( σ \) r rSup { size 8{*} }  \( σ - t \) e rSup { size 8{ - j2 ital "πφσ"} } dσ} } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10344828">Which can be rewritten as:</para>
      <para id="id10220932">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>m</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mi>,</m:mi>
                    <m:mi>φ</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msup>
                        <m:mi>e</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mi fontstyle="italic">j2</m:mi>
                              <m:mstyle fontstyle="italic">
                                <m:mrow>
                                  <m:mtext>πφ</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                              <m:mi>t</m:mi>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                      </m:msup>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:mi>y</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>t</m:mi>
                          <m:mo stretchy="false">+</m:mo>
                          <m:msup>
                            <m:mi>σ</m:mi>
                            <m:mi>'</m:mi>
                          </m:msup>
                        </m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:msup>
                          <m:mi>r</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow/>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">(</m:mo>
                        <m:msup>
                          <m:mi>σ</m:mi>
                          <m:mi>'</m:mi>
                        </m:msup>
                        <m:mo stretchy="false">)</m:mo>
                        <m:msup>
                          <m:mi>e</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:msup>
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mi fontstyle="italic">j2</m:mi>
                                  </m:mrow>
                                  <m:mstyle fontstyle="italic">
                                    <m:mrow>
                                      <m:mtext>πφ {</m:mtext>
                                    </m:mrow>
                                  </m:mstyle>
                                  <m:mstyle fontstyle="italic">
                                    <m:mrow>
                                      <m:mi>σ</m:mi>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:mrow>
                                <m:mi>'</m:mi>
                              </m:msup>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>d</m:mi>
                    <m:msup>
                      <m:mi>σ</m:mi>
                      <m:mi>'</m:mi>
                    </m:msup>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow>
                <m:mrow/>
                <m:mrow/>
              </m:mrow>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) =e rSup { size 8{j2 ital "πφ"t} }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {y \( t+ { {σ}} sup { ' } \) r rSup { size 8{*} }  \(  { {σ}} sup { ' } \) e rSup { size 8{ - j2 ital "πφ {" ital {σ}} sup { ' }} } d { {σ}} sup { ' }} } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id12130305">The spectrogram with window function 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>w</m:mi><m:mo stretchy="false">(</m:mo><m:mi>σ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{w \( σ \) } {}</m:annotation></m:semantics></m:math> is given by:</para>
      <para id="id8607743">
        <m:math>
          <m:semantics>
            <m:mtable>
              <m:mtr>
                <m:mrow>
                  <m:mrow>
                    <m:munderover>
                      <m:mo stretchy="false">∫</m:mo>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mrow>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mrow>
                      </m:mstyle>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mo stretchy="false">∞</m:mo>
                        </m:mrow>
                      </m:mstyle>
                    </m:munderover>
                    <m:mrow>
                      <m:mi>y</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mrow>
                        <m:mi>t</m:mi>
                        <m:mo stretchy="false">+</m:mo>
                        <m:msup>
                          <m:mi>σ</m:mi>
                          <m:mi>'</m:mi>
                        </m:msup>
                      </m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mi>w</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:msup>
                        <m:mi>σ</m:mi>
                        <m:mi>'</m:mi>
                      </m:msup>
                      <m:mo stretchy="false">)</m:mo>
                      <m:msup>
                        <m:mi>e</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:msup>
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mi fontstyle="italic">j2</m:mi>
                                </m:mrow>
                                <m:mstyle fontstyle="italic">
                                  <m:mrow>
                                    <m:mtext>πφ {</m:mtext>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontstyle="italic">
                                  <m:mrow>
                                    <m:mi>σ</m:mi>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                              <m:mi>'</m:mi>
                            </m:msup>
                          </m:mrow>
                        </m:mstyle>
                      </m:msup>
                    </m:mrow>
                  </m:mrow>
                  <m:mi>d</m:mi>
                  <m:msup>
                    <m:mi>σ</m:mi>
                    <m:mi>'</m:mi>
                  </m:msup>
                </m:mrow>
              </m:mtr>
              <m:mtr>
                <m:mrow>
                  <m:mstyle fontsize="12pt">
                    <m:mrow>
                      <m:mrow>
                        <m:mi>Φ</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>t</m:mi>
                        <m:mi>,</m:mi>
                        <m:mi>φ</m:mi>
                        <m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mo stretchy="false">=</m:mo>
                          <m:msup>
                            <m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                              <m:mrow/>
                              <m:mo stretchy="false">∣</m:mo>
                            </m:mrow>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mstyle>
                  <m:mrow/>
                </m:mrow>
              </m:mtr>
            </m:mtable>
            <m:annotation encoding="StarMath 5.0"> size 12{Φ \( t,φ \) = lline  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {y \( t+ { {σ}} sup { ' } \) w \(  { {σ}} sup { ' } \) e rSup { size 8{ - j2 ital "πφ {" ital {σ}} sup { ' }} } d { {σ}} sup { ' }}  rline  rSup { size 8{2} } } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10793964">Hence, the squared envelope of the narrowband Doppler matched filter is a spectrogram with the window function being the conjugate of the transmitted waveform replica. This interpretation of narrowband matched filtering lends insight into the use of different window functions on transmitted waveforms. Often one adds a Hanning or Tukey window to the transmitted waveform. This windowing is necessary in some cases because the sonar transmitter cannot turn on and off instantly. </para>
      <para id="id11413406">In spectral analysis, windows are used to control ‘spectral leakage’, which occurs because of the finite time window used for frequency analysis. Spectral leakage generates sidelobes from strong tones that mask low amplitude tones at different frequencies. In a matched filter using Doppler resolving waveforms, reverberation will be much stronger near zero Doppler than at other Doppler frequencies. The waveform windows help keep Doppler sidelobes of reverberation from masking the lower amplitude target echoes that may occur at high Doppler. </para>
      <para id="id10635325">Using matched filters based on the narrowband approximation to process echoes with Doppler beyond the narrowband approximation limits will result in correlation loss. The correlation loss will result in a loss of Signal to Noise ratio for these echoes.</para>
      <para id="id10635333">This presents a fundamental design decision for a sonar system that needs to process echoes with Doppler on the order of 15 knots or greater. If one uses “narrowband” processing for efficiency, then one has to limit the waveforms to those that satisfy the narrowband approximation. However, as shown in the earlier sections, having a larger bandwidth will reduce the autocorrelation time of the waveform and thus reduce the response to reverberation. This reverberation versus bandwidth property advocates the use of wideband waveforms and hence, broadband matched filtering. There are, however, waveforms that have low correlation loss across all Doppler shifts. These are known as hyperbolic frequency modulation (HFM) waveforms. </para>
      <para id="id11651520">So, one can use narrowband processing, and restrict the waveforms to low bandwidth (1 Hertz say) waveforms such as a pulsed sine wave, and wideband waveforms with high Doppler tolerance, such as HFM. If one wants to use waveforms that have Doppler resolving power and high bandwidth, one needs to use broadband matched filtering. </para>
    </section>
    <section id="id-0685068249714">
      <title>Doppler Sensitive Waveform Matched Filtering</title>
      <para id="id11210505">In some cases, one uses a signal that is Doppler sensitive, e.g. the signal ambiguity function 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>χ</m:mi><m:mo stretchy="false">(</m:mo><m:mi>τ</m:mi><m:mi>,</m:mi><m:mi>η</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{χ \( τ,η \) } {}</m:annotation></m:semantics></m:math>is a strong function of the Doppler variable. Examples of these waveforms are CW, SFM and comb waveforms. Other waveforms are less sensitive to Doppler effects, beyond a time delay/Doppler coupling effect. </para>
      <para id="id10622621">In the cases where one is using Doppler sensitive waveforms, the matched filter is generalized to a matched filter bank, indexed by both time (range) and Doppler (
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>η</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{η \) } {}</m:annotation></m:semantics></m:math></para>
      <para id="id11237139">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>m</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mi>,</m:mi>
                    <m:mi>η</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msqrt>
                        <m:mi>η</m:mi>
                      </m:msqrt>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>t</m:mi>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mi>t</m:mi>
                              <m:mo stretchy="false">+</m:mo>
                              <m:mrow>
                                <m:mi>T</m:mi>
                                <m:mo stretchy="false">/</m:mo>
                                <m:mi>η</m:mi>
                              </m:mrow>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:mi>y</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>σ</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>r</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>η</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>σ</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>t</m:mi>
                        </m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi fontstyle="italic">dσ</m:mi>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{m \( t,η \) = sqrt {η}  Int cSub { size 8{t} }  cSup { size 8{t+T/η} }  {y \( σ \) r \( η \( σ - t \)  \) dσ} } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id8604215">This allows one to search for targets that have relative motion to the source and receivers of the active sonar. When the received signal is a Doppler scaled echo, then the filter that matches the echo Doppler will be a matched filter for that echo, and obey the same SNR properties for echoes embedded in noise as the earlier discussion for stationary targets echoes. The replica is matched to the echo compression and time delay. To ensure energy consistency, we scale the zero Doppler replica 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>r</m:mi><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{r \( t \) } {}</m:annotation></m:semantics></m:math> by 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msqrt><m:mi>η</m:mi></m:msqrt></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ sqrt {η} } {}</m:annotation></m:semantics></m:math> when using it for other Doppler hypotheses. This comes from the fact that </para>
      <para id="id10514223">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mi>T</m:mi>
                              <m:mo stretchy="false">/</m:mo>
                              <m:mi>η</m:mi>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:msup>
                          <m:mi>r</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>2</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi fontstyle="italic">ηt</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mstyle fontstyle="italic">
                          <m:mrow>
                            <m:mtext>dt</m:mtext>
                          </m:mrow>
                        </m:mstyle>
                      </m:mrow>
                    </m:mrow>
                    <m:mo stretchy="false">=</m:mo>
                    <m:mrow>
                      <m:mn>1</m:mn>
                      <m:mo stretchy="false">/</m:mo>
                      <m:mi>η</m:mi>
                    </m:mrow>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{ Int cSub { size 8{0} }  cSup { size 8{T/η} }  {r rSup { size 8{2} }  \( ηt \)  ital "dt"} =1/η} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id9139657">Now, using the reverberation model as before, we have the following expression for the matched filter bank response to reverberation:</para>
      <para id="id9139663">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:msub>
                      <m:mi>m</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mi>R</m:mi>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mi>,</m:mi>
                    <m:mi>η</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msqrt>
                        <m:msub>
                          <m:mi fontstyle="italic">ηE</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:msqrt>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:mi>A</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>Γ</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mrow>
                          <m:msubsup>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>t</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>t</m:mi>
                                  <m:mo stretchy="false">+</m:mo>
                                  <m:mrow>
                                    <m:mi>T</m:mi>
                                    <m:mo stretchy="false">/</m:mo>
                                    <m:mi>η</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mrow>
                            <m:mi>r</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>σ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>τ</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>u</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>r</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>η</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>σ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>t</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                        </m:mrow>
                        <m:mi fontstyle="italic">dσd</m:mi>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>u</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{m rSub { size 8{R} }  \( t,η \) = sqrt {ηE rSub { size 8{T} } }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {A \( u \) Γ \( u \)  Int rSub { size 8{t} }  rSup { size 8{t+T/η} }  {r \( σ - τ \( u \)  \) r \( η \( σ - t \)  \) } dσd} u} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11613219">The integral including the replicas, using the change of variables 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msup><m:mi>σ</m:mi><m:mi>'</m:mi></m:msup><m:mo stretchy="false">=</m:mo><m:mrow><m:mi>σ</m:mi><m:mo stretchy="false">−</m:mo><m:mi>t</m:mi></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ { {σ}} sup { ' }=σ - t} {}</m:annotation></m:semantics></m:math>, can be written as</para>
      <para id="id11428650"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mrow><m:msub><m:mi>I</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mrow><m:mi>δ</m:mi><m:mi>,</m:mi><m:mi>η</m:mi></m:mrow></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">=</m:mo><m:mrow><m:msubsup><m:mo stretchy="false">∫</m:mo><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle><m:mstyle fontsize="8pt"><m:mrow><m:mrow><m:mi>T</m:mi><m:mo stretchy="false">/</m:mo><m:mi>η</m:mi></m:mrow></m:mrow></m:mstyle></m:msubsup><m:mrow><m:mi>r</m:mi><m:mo stretchy="false">(</m:mo><m:mrow><m:msup><m:mi>σ</m:mi><m:mi>'</m:mi></m:msup><m:mo stretchy="false">+</m:mo><m:mi>δ</m:mi></m:mrow><m:mo stretchy="false">)</m:mo><m:mi>r</m:mi><m:mo stretchy="false">(</m:mo><m:mi>η</m:mi><m:msup><m:mi>σ</m:mi><m:mi>'</m:mi></m:msup><m:mo stretchy="false">)</m:mo><m:mi>d</m:mi></m:mrow></m:mrow></m:mrow><m:msup><m:mi>σ</m:mi><m:mi>'</m:mi></m:msup></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{I rSub { size 8{δ,η} } = Int rSub { size 8{0} }  rSup { size 8{T/η} }  {r \(  { {σ}} sup { ' }+δ \) r \( η { {σ}} sup { ' } \) d}  { {σ}} sup { ' }} {}</m:annotation></m:semantics></m:math>, where 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mrow><m:mi>δ</m:mi><m:mo stretchy="false">=</m:mo><m:mrow><m:mi>t</m:mi><m:mo stretchy="false">−</m:mo><m:mi>τ</m:mi></m:mrow></m:mrow><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{δ=t - τ \( u \) } {}</m:annotation></m:semantics></m:math></para>
      <para id="id10160667">We can extend the limits of the integral, because 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>r</m:mi><m:mo stretchy="false">(</m:mo><m:mi>η</m:mi><m:msup><m:mi>σ</m:mi><m:mi>'</m:mi></m:msup><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{r \( η { {σ}} sup { ' } \) } {}</m:annotation></m:semantics></m:math>is zero outside the integration limits. Extending limits and changing variables to 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msup><m:mi>σ</m:mi><m:mrow><m:mi>'</m:mi><m:mi>'</m:mi></m:mrow></m:msup><m:mo stretchy="false">=</m:mo><m:mrow><m:msup><m:mi>σ</m:mi><m:mi>'</m:mi></m:msup><m:mo stretchy="false">+</m:mo><m:mi>δ</m:mi></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ { {σ}} sup { '' }= { {σ}} sup { ' }+δ} {}</m:annotation></m:semantics></m:math>yields</para>
      <para id="id9896769">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mrow>
                      <m:msub>
                        <m:mi>I</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mi>δ</m:mi>
                              <m:mi>,</m:mi>
                              <m:mi>η</m:mi>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mrow>
                        <m:msubsup>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:msubsup>
                        <m:mrow>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:msup>
                            <m:mi>σ</m:mi>
                            <m:mrow>
                              <m:mi>'</m:mi>
                              <m:mi>'</m:mi>
                            </m:mrow>
                          </m:msup>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>r</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:msup>
                              <m:mi>σ</m:mi>
                              <m:mrow>
                                <m:mi>'</m:mi>
                                <m:mi>'</m:mi>
                              </m:mrow>
                            </m:msup>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>δ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>d</m:mi>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                    <m:mrow>
                      <m:msup>
                        <m:mi>σ</m:mi>
                        <m:mrow>
                          <m:mi>'</m:mi>
                          <m:mi>'</m:mi>
                        </m:mrow>
                      </m:msup>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mi>χ</m:mi>
                    </m:mrow>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>δ</m:mi>
                    <m:mi>,</m:mi>
                    <m:mi>η</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">/</m:mo>
                      <m:mi>η</m:mi>
                    </m:mrow>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{I rSub { size 8{δ,η} } = Int rSub { size 8{ -  infinity } }  rSup { size 8{ infinity } }  {r \(  { {σ}} sup { '' } \) r \( η \(  { {σ}} sup { '' } - δ \)  \) d}  { {σ}} sup { '' }=χ \( δ,η \) /η} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11748646">Hence the range Doppler matched filter bank response to reverberation becomes</para>
      <para id="id11611725">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:msub>
                      <m:mi>m</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mi>R</m:mi>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>t</m:mi>
                    <m:mi>,</m:mi>
                    <m:mi>η</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msqrt>
                        <m:msub>
                          <m:mi>E</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:msqrt>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:mi>A</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>Γ</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>χ</m:mi>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>t</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>τ</m:mi>
                        </m:mrow>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>,</m:mi>
                        <m:mi>η</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>d</m:mi>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>u</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{m rSub { size 8{R} }  \( t,η \) = sqrt {E rSub { size 8{T} } }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {A \( u \) Γ \( u \) χ \( t - τ \( u \) ,η \) d} u} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id9693975">This expression shows that if the target has Doppler, and one uses a replica matched to the target Doppler, further suppression of reverberation is possible. This suppression of reverberation is without loss to matching the target echo or loss in noise limited performance. </para>
      <para id="id9693985">Choosing waveforms that are broadband, and with roll-off with respect to Doppler in its signal ambiguity function, will optimize the active sonar’s processing in reverberation. For some waveforms (such as the Sinusoidal Frequency Modulation pulse) the signal ambiguity function will have multiple time delay peaks, termed ‘fingers’, due to the periodic structure of the pulse. Each autocorrelation finger has a time width approximately equal to the signal’s bandwidth. This will increase the reverberation response, relative to a waveform with a single autocorrelation response. However, the SFM waveform has a roll-off in Doppler as well. So for targets that have Doppler, there can be a Doppler shift where the roll-off in Doppler more than compensates for the additional autocorrelation peaks.</para>
      <para id="id7575285">We will make the assumption that A(u) is wide sense stationary, that is its statistics are invariant over the range of u:</para>
      <para id="id11494962">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msup>
                            <m:mi>A</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow/>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>A</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>v</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>R</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>A</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mrow>
                      <m:mi>u</m:mi>
                      <m:mo stretchy="false">−</m:mo>
                      <m:mi>v</m:mi>
                    </m:mrow>
                    <m:mo stretchy="false">)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace A rSup { size 8{*} }  \( u \) A \( v \)  right rbrace =R rSub { size 8{A} }  \( u - v \) } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10532126">Furthermore, we will assume that A(u) is spatially white, e.g. the scattering elements are uncorrelated with each other:</para>
      <para id="id10532137">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:mi>A</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:msup>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow/>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mi>A</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>v</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>R</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>A</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mrow>
                      <m:mi>u</m:mi>
                      <m:mo stretchy="false">−</m:mo>
                      <m:mi>v</m:mi>
                    </m:mrow>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>R</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>A</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:mi>δ</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mrow>
                      <m:mi>u</m:mi>
                      <m:mo stretchy="false">−</m:mo>
                      <m:mi>v</m:mi>
                    </m:mrow>
                    <m:mo stretchy="false">)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace A \( u \)  rSup { size 8{*} } A \( v \)  right rbrace =R rSub { size 8{A} }  \( u - v \) =R rSub { size 8{A} } δ \( u - v \) } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10386230">Now, these two assumptions, that the reflection coefficient statistics are independent of range and each differential patch is statistically independent of each other is only an approximation to the real situation. However, these approximations allow one to see the interaction of reverberation and waveform selection.</para>
      <para id="id10964627">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>m</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mi>E</m:mi>
                    </m:mrow>
                    <m:mfenced open="{" close="}">
                      <m:mrow>
                        <m:msub>
                          <m:mi>E</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>0</m:mn>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:mi>A</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>u</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>Γ</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>u</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>χ</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>t</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>τ</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>u</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>,</m:mi>
                            <m:mi>η</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>d</m:mi>
                          </m:mrow>
                        </m:mrow>
                        <m:mi>u</m:mi>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>0</m:mn>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:mi>A</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>Γ</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>χ</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>t</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>τ</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>,</m:mi>
                            <m:mi>η</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>d</m:mi>
                          </m:mrow>
                        </m:mrow>
                        <m:mi>φ</m:mi>
                      </m:mrow>
                    </m:mfenced>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace m rSub { size 8{R} }  rSup { size 8{2} }  \( t,η \)  right rbrace =E left lbrace E rSub { size 8{T} }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {A \( u \) Γ \( u \) χ \( t - τ \( u \) ,η \) d} u Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {A \( φ \) Γ \( φ \) χ \( t - τ \( φ \) ,η \) d} φ right rbrace } {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11417613">Rearranging,</para>
      <para id="id11417617">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>m</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>E</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>T</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>0</m:mn>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:mi>E</m:mi>
                          <m:mfenced open="{" close="}">
                            <m:mrow>
                              <m:mi>A</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mi>u</m:mi>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi>A</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mi>φ</m:mi>
                              <m:mo stretchy="false">)</m:mo>
                            </m:mrow>
                          </m:mfenced>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>φ</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>χ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>t</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>τ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>χ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>t</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>τ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>φ</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>d</m:mi>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                    <m:mstyle fontstyle="italic">
                      <m:mrow>
                        <m:mtext>ud</m:mtext>
                      </m:mrow>
                    </m:mstyle>
                    <m:mi>φ</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace m rSub { size 8{R} }  rSup { size 8{2} }  \( t,η \)  right rbrace =E rSub { size 8{T} }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  { Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {E left lbrace A \( u \) A \( φ \)  right rbrace Γ \( u \) Γ \( φ \) χ \( t - τ \( u \) ,η \) χ \( t - τ \( φ \) ,η \) d} }  ital "ud"φ} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10300833">Using the covariance of the scattering elements we get,</para>
      <para id="id11639088">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>m</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>E</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>T</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>0</m:mn>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:msub>
                            <m:mi>R</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>A</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                          <m:mi>δ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>u</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>φ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>φ</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>χ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>t</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>τ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>u</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>χ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>t</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>τ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>φ</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi>d</m:mi>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                    <m:mstyle fontstyle="italic">
                      <m:mrow>
                        <m:mtext>ud</m:mtext>
                      </m:mrow>
                    </m:mstyle>
                    <m:mi>φ</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace m rSub { size 8{R} }  rSup { size 8{2} }  \( t,η \)  right rbrace =E rSub { size 8{T} }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  { Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {R rSub { size 8{A} } δ \( u - φ \) Γ \( u \) Γ \( φ \) χ \( t - τ \( u \) ,η \) χ \( t - τ \( φ \) ,η \) d} }  ital "ud"φ} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id12092748">Or,</para>
      <para id="id12092751">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>m</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>E</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>T</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:msub>
                      <m:mi>R</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mi>A</m:mi>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:msup>
                          <m:mrow>
                            <m:mo stretchy="false">∣</m:mo>
                            <m:mrow>
                              <m:mi>Γ</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mi>u</m:mi>
                              <m:mo stretchy="false">)</m:mo>
                            </m:mrow>
                            <m:mo stretchy="false">∣</m:mo>
                          </m:mrow>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>2</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:msup>
                          <m:mi>χ</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>2</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>t</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>τ</m:mi>
                        </m:mrow>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>,</m:mi>
                        <m:mi>η</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>d</m:mi>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>u</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace m rSub { size 8{R} }  rSup { size 8{2} }  \( t,η \)  right rbrace =E rSub { size 8{T} } R rSub { size 8{A} }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  { lline Γ \( u \)  rline  rSup { size 8{2} } χ rSup { size 8{2} }  \( t - τ \( u \) ,η \) d} u} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id12107645">To see this more clearly, assume that the transmission loss term 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>Γ</m:mi><m:mo stretchy="false">(</m:mo><m:mi>u</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Γ \( u \) } {}</m:annotation></m:semantics></m:math>is approximately constant over the transmitted signal’s correlation time and receiver’s beam pattern. Then we obtain</para>
      <para id="id10896417">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>m</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>E</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>T</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:msub>
                      <m:mi>R</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mi>A</m:mi>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:msup>
                      <m:mrow>
                        <m:mo stretchy="false">∣</m:mo>
                        <m:mrow>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>0</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                        <m:mo stretchy="false">∣</m:mo>
                      </m:mrow>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mn>2</m:mn>
                        </m:mrow>
                      </m:mstyle>
                    </m:msup>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:msup>
                          <m:mi>χ</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>2</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>t</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>τ</m:mi>
                        </m:mrow>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>u</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>,</m:mi>
                        <m:mi>η</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>d</m:mi>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>u</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace m rSub { size 8{R} }  rSup { size 8{2} }  \( t,η \)  right rbrace =E rSub { size 8{T} } R rSub { size 8{A} }  lline Γ \( u rSub { size 8{0} }  \)  rline  rSup { size 8{2} }  Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {χ rSup { size 8{2} }  \( t - τ \( u \) ,η \) d} u} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10386995">Where 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>u</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{u rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>is defined by
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>τ</m:mi><m:mo stretchy="false">(</m:mo><m:msub><m:mi>u</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:mi>t</m:mi></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ \( u rSub { size 8{0} }  \) =t} {}</m:annotation></m:semantics></m:math>. </para>
      <para id="id10124074">If we assume that the time delay varies smoothly with respect to range, we can replace the integration over u with an integration over time delay 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>τ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ} {}</m:annotation></m:semantics></m:math>, where we assume that the chance of variable from u to 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>τ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ} {}</m:annotation></m:semantics></m:math>is approximately given by 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>τ</m:mi><m:mo stretchy="false">=</m:mo><m:mrow><m:mn>2u</m:mn><m:mo stretchy="false">/</m:mo><m:mi>c</m:mi></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ=2u/c} {}</m:annotation></m:semantics></m:math>, where c is the speed of sound. This is assuming an approximate monostatic geometry, or that the patch of reverberation is far away relative to the source receiver separation.</para>
      <para id="id10296886">We then get</para>
      <para id="id10296890">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>m</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>E</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>T</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:msub>
                      <m:mi>R</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mi>A</m:mi>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:msup>
                      <m:mrow>
                        <m:mo stretchy="false">∣</m:mo>
                        <m:mrow>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>0</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                        <m:mo stretchy="false">∣</m:mo>
                      </m:mrow>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mn>2</m:mn>
                        </m:mrow>
                      </m:mstyle>
                    </m:msup>
                    <m:mrow>
                      <m:mi>c</m:mi>
                      <m:mo stretchy="false">/</m:mo>
                      <m:mn>2</m:mn>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:msup>
                          <m:mi>χ</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>2</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>t</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>τ</m:mi>
                        </m:mrow>
                        <m:mi>,</m:mi>
                        <m:mi>η</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>d</m:mi>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>τ</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace m rSub { size 8{R} }  rSup { size 8{2} }  \( t,η \)  right rbrace =E rSub { size 8{T} } R rSub { size 8{A} }  lline Γ \( u rSub { size 8{0} }  \)  rline  rSup { size 8{2} } c/2 Int cSub { size 8{0} }  cSup { size 8{ infinity } }  {χ rSup { size 8{2} }  \( t - τ,η \) d} τ} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id10467747">If we assume that the matched filter time t is greater than the signal duration T, then letting 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msup><m:mi>τ</m:mi><m:mi>'</m:mi></m:msup><m:mo stretchy="false">=</m:mo><m:mrow><m:mi>t</m:mi><m:mo stretchy="false">−</m:mo><m:mi>τ</m:mi></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ { {τ}} sup { ' }=t - τ} {}</m:annotation></m:semantics></m:math>, we obtain</para>
      <para id="id11130892">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>m</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>E</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>T</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:msub>
                      <m:mi>R</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mi>A</m:mi>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:msup>
                      <m:mrow>
                        <m:mo stretchy="false">∣</m:mo>
                        <m:mrow>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>0</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                        <m:mo stretchy="false">∣</m:mo>
                      </m:mrow>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mn>2</m:mn>
                        </m:mrow>
                      </m:mstyle>
                    </m:msup>
                    <m:mrow>
                      <m:mi>c</m:mi>
                      <m:mo stretchy="false">/</m:mo>
                      <m:mn>2</m:mn>
                    </m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:msup>
                          <m:mi>χ</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>2</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mrow>
                          <m:mi>t</m:mi>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mi>τ</m:mi>
                        </m:mrow>
                        <m:mi>,</m:mi>
                        <m:mi>η</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mi>d</m:mi>
                      </m:mrow>
                    </m:mrow>
                    <m:mi>τ</m:mi>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace m rSub { size 8{R} }  rSup { size 8{2} }  \( t,η \)  right rbrace =E rSub { size 8{T} } R rSub { size 8{A} }  lline Γ \( u rSub { size 8{0} }  \)  rline  rSup { size 8{2} } c/2 Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {χ rSup { size 8{2} }  \( t - τ,η \) d} τ} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id9209433">We define the Q-function of the waveform as</para>
      <para id="id10747848">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>Q</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>η</m:mi>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:msup>
                            <m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                              <m:mrow>
                                <m:mi>χ</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:msup>
                                  <m:mi>τ</m:mi>
                                  <m:mi>'</m:mi>
                                </m:msup>
                                <m:mi>,</m:mi>
                                <m:mi>η</m:mi>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                            </m:mrow>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mi>d</m:mi>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                    <m:msup>
                      <m:mi>τ</m:mi>
                      <m:mi>'</m:mi>
                    </m:msup>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{Q \( η \) = Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { lline χ \(  { {τ}} sup { ' },η \)  rline  rSup { size 8{2} } d}  { {τ}} sup { ' }} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11400730">Note that 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>Q</m:mi><m:mo stretchy="false">(</m:mo><m:mi>η</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Q \( η \) } {}</m:annotation></m:semantics></m:math>has units of seconds^2. We call a waveform with a sharp peak in 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>Q</m:mi><m:mo stretchy="false">(</m:mo><m:mi>η</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Q \( η \) } {}</m:annotation></m:semantics></m:math>as a Doppler Sensitive Waveform (DSW). A sine wave pulse will have a sharp peak in 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>Q</m:mi><m:mo stretchy="false">(</m:mo><m:mi>η</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Q \( η \) } {}</m:annotation></m:semantics></m:math> for instance. </para>
      <para id="id11417044">When the narrowband ambiguity function is used the Q function is normalized:</para>
      <para id="id11417050">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mrow>
                      <m:munderover>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mo stretchy="false">∞</m:mo>
                          </m:mrow>
                        </m:mstyle>
                      </m:munderover>
                      <m:mrow>
                        <m:msub>
                          <m:mi>Q</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mstyle fontstyle="italic">
                                <m:mrow>
                                  <m:mtext>NB</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>φ</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                      </m:mrow>
                    </m:mrow>
                    <m:mrow>
                      <m:mi fontstyle="italic">dφ</m:mi>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:msup>
                            <m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                              <m:mrow>
                                <m:msub>
                                  <m:mi>χ</m:mi>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mstyle fontstyle="italic">
                                        <m:mrow>
                                          <m:mtext>NB</m:mtext>
                                        </m:mrow>
                                      </m:mstyle>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msub>
                                <m:mo stretchy="false">(</m:mo>
                                <m:msup>
                                  <m:mi>τ</m:mi>
                                  <m:mi>'</m:mi>
                                </m:msup>
                                <m:mi>,</m:mi>
                                <m:mi>φ</m:mi>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                            </m:mrow>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mi>d</m:mi>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                    <m:msup>
                      <m:mi>τ</m:mi>
                      <m:mi>'</m:mi>
                    </m:msup>
                    <m:mrow>
                      <m:mi fontstyle="italic">dφ</m:mi>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{ Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {Q rSub { size 8{ ital "NB"} }  \( φ \) } dφ= Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { lline χ rSub { size 8{ ital "NB"} }  \(  { {τ}} sup { ' },φ \)  rline  rSup { size 8{2} } d}  { {τ}} sup { ' }dφ=1} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11101332">The wideband waveform Q function is approximately normalized to unity.</para>
      <para id="id11101338">The reverberation response can be written as</para>
      <para id="id10613649">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mrow>
                      <m:mfenced open="{" close="}">
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>m</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>R</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msubsup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>η</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mfenced>
                      <m:mo stretchy="false">=</m:mo>
                      <m:msub>
                        <m:mi>E</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>T</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                    </m:mrow>
                    <m:msub>
                      <m:mi>R</m:mi>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mi>A</m:mi>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:msup>
                      <m:mrow>
                        <m:mo stretchy="false">∣</m:mo>
                        <m:mrow>
                          <m:mi>Γ</m:mi>
                          <m:mo stretchy="false">(</m:mo>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>0</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                        <m:mo stretchy="false">∣</m:mo>
                      </m:mrow>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mn>2</m:mn>
                        </m:mrow>
                      </m:mstyle>
                    </m:msup>
                    <m:mi>Q</m:mi>
                    <m:mo stretchy="false">(</m:mo>
                    <m:mi>η</m:mi>
                    <m:mo stretchy="false">)</m:mo>
                    <m:mrow>
                      <m:mi>c</m:mi>
                      <m:mo stretchy="false">/</m:mo>
                      <m:mn>2</m:mn>
                    </m:mrow>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace m rSub { size 8{R} }  rSup { size 8{2} }  \( t,η \)  right rbrace =E rSub { size 8{T} } R rSub { size 8{A} }  lline Γ \( u rSub { size 8{0} }  \)  rline  rSup { size 8{2} } Q \( η \) c/2} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11756839">Clearly, the best waveform to use for detection depends on the assumed target velocity. Waveforms such as HFM and LFM have low Q-functions that are relatively constant across Doppler. Doppler sensitive waveforms often have lower Q-functions at higher Doppler shifts than LFM and HFM, much higher Q functions near zero Doppler. To best search for targets, one needs waveforms optimized for both low and high Doppler targets.</para>
      <para id="id10998802">So far, this has been a deterministic description of the matched filter response to reverberation. </para>
      <section id="id-204868886269">
        <title>Channel Doppler Effects on Reverberation</title>
        <para id="id10350217">In reality, the reflection coefficient or the transmission loss term will be time varying (as well as spatially varying) because of the surface of the ocean having waves, and the internal thermal structure of the ocean channel will be time varying. </para>
        <para id="id10350225">For bottom reverberation, we will assume that the reflection coefficient is time invariant. In shallow water at low frequencies (&lt; 2000 Hz, say) the bottom reverberation dominates over surface reverberation. However, the acoustic propagation through the sound channel and specular reflection from the ocean surface introduces a time varying component to the reverberation formation process.</para>
        <para id="id10836222">To derive the results needed for channel Doppler effects, we will restrict ourselves to the narrowband model.</para>
        <para id="id10836229">The matched filter is given by:</para>
        <para id="id10836233">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>t</m:mi>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>t</m:mi>
                                  <m:mo stretchy="false">+</m:mo>
                                  <m:mi>T</m:mi>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:mi>y</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>σ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:msup>
                              <m:mi>r</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow/>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>σ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>t</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:msup>
                              <m:mi>e</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">−</m:mo>
                                      <m:mi fontstyle="italic">j2</m:mi>
                                    </m:mrow>
                                    <m:mstyle fontstyle="italic">
                                      <m:mrow>
                                        <m:mtext>πφσ</m:mtext>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                            <m:mi fontstyle="italic">dσ</m:mi>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) = Int cSub { size 8{t} }  cSup { size 8{t+T} }  {y \( σ \) r rSup { size 8{*} }  \( σ - t \) e rSup { size 8{ - j2 ital "πφσ"} } dσ} } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11253291">Since 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>r</m:mi><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:mn>0</m:mn></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{r \( t \) =0} {}</m:annotation></m:semantics></m:math>for 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>t</m:mi><m:mo stretchy="false">&lt;</m:mo><m:mn>0</m:mn></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{t&lt;0} {}</m:annotation></m:semantics></m:math>and 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>t</m:mi><m:mo stretchy="false">&gt;</m:mo><m:mi>T</m:mi></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{t&gt;T} {}</m:annotation></m:semantics></m:math>, we extend the limits of integration for the matched filter response to:</para>
        <para id="id11181369">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:mi>y</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>σ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:msup>
                              <m:mi>r</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow/>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>σ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>t</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:msup>
                              <m:mi>e</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">−</m:mo>
                                      <m:mi fontstyle="italic">j2</m:mi>
                                    </m:mrow>
                                    <m:mstyle fontstyle="italic">
                                      <m:mrow>
                                        <m:mtext>πφσ</m:mtext>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                            <m:mi fontstyle="italic">dσ</m:mi>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) = Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {y \( σ \) r rSup { size 8{*} }  \( σ - t \) e rSup { size 8{ - j2 ital "πφσ"} } dσ} } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10761669">We define the effects of reverberation, targets, clutter and the acoustic channel, via a spreading function 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>S</m:mi><m:mo stretchy="false">(</m:mo><m:mi>τ</m:mi><m:mi>,</m:mi><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{S \( τ,φ \) } {}</m:annotation></m:semantics></m:math> acting on the transmitted waveform:</para>
        <para id="id11387903">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>y</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msqrt>
                          <m:msub>
                            <m:mi>E</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>T</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:msqrt>
                      </m:mrow>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:mi>S</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>τ</m:mi>
                            <m:mi>,</m:mi>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:msup>
                              <m:mi>e</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mi fontstyle="italic">j2</m:mi>
                                    <m:mstyle fontstyle="italic">
                                      <m:mrow>
                                        <m:mtext>πφ</m:mtext>
                                      </m:mrow>
                                    </m:mstyle>
                                    <m:mi>t</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                            <m:mi>r</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>t</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>τ</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi fontstyle="italic">dτdφ</m:mi>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{y \( t \) = sqrt {E rSub { size 8{T} } }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {S \( τ,φ \) e rSup { size 8{j2 ital "πφ"t} } r \( t - τ \) dτdφ} } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10517367">This expression does not include contributions of ambient noise, only scattering phenomena. The spreading function 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>S</m:mi><m:mo stretchy="false">(</m:mo><m:mi>τ</m:mi><m:mi>,</m:mi><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{S \( τ,φ \) } {}</m:annotation></m:semantics></m:math>defines the acoustic scattering, as a function of delay 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>τ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ} {}</m:annotation></m:semantics></m:math>and Doppler shift 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>φ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{φ} {}</m:annotation></m:semantics></m:math> for the sonar reception. The spreading function is a random variable, changing due to surface waves and time varying refraction effects (internal waves) in the sound channel. </para>
        <para id="id10468436">Target echoes will have a small 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>τ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ} {}</m:annotation></m:semantics></m:math>region of non-zero spreading function, 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msub><m:mi>S</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mtext>Target</m:mtext></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">(</m:mo><m:mi>τ</m:mi><m:mi>,</m:mi><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{S rSub { size 8{"Target"} }  \( τ,φ \) } {}</m:annotation></m:semantics></m:math>. Reverberation will have an extended 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>τ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{τ} {}</m:annotation></m:semantics></m:math> region with significant 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msub><m:mi>S</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mtext>Reverb</m:mtext></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">(</m:mo><m:mi>τ</m:mi><m:mi>,</m:mi><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{S rSub { size 8{"Reverb"} }  \( τ,φ \) } {}</m:annotation></m:semantics></m:math>. The Doppler shift for both reverberation and targets will be related to receiver and source motion, as well as Doppler spreading due to surface and internal waves. The target will have additional Doppler contributions from its own motion.</para>
        <para id="id12129804">Substituting the spreading function description to the sonar response into the matched filter we obtain</para>
        <para id="id10455106">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msqrt>
                          <m:msub>
                            <m:mi>E</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>T</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:msqrt>
                      </m:mrow>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∫</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mo stretchy="false">∞</m:mo>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:munderover>
                                <m:mo stretchy="false">∫</m:mo>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">−</m:mo>
                                      <m:mo stretchy="false">∞</m:mo>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mo stretchy="false">∞</m:mo>
                                  </m:mrow>
                                </m:mstyle>
                              </m:munderover>
                              <m:mrow>
                                <m:mi>S</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:mi>τ</m:mi>
                                <m:mi>,</m:mi>
                                <m:mi>δ</m:mi>
                                <m:mo stretchy="false">)</m:mo>
                                <m:msup>
                                  <m:mi>e</m:mi>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mrow>
                                        <m:mi fontstyle="italic">j2</m:mi>
                                        <m:mstyle fontstyle="italic">
                                          <m:mrow>
                                            <m:mtext>πδσ</m:mtext>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mrow>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msup>
                                <m:mi>r</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:mrow>
                                  <m:mi>σ</m:mi>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mi>τ</m:mi>
                                </m:mrow>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mrow>
                          <m:msup>
                            <m:mi>r</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow/>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>σ</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>t</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:msup>
                            <m:mi>e</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mi fontstyle="italic">j2</m:mi>
                                  </m:mrow>
                                  <m:mstyle fontstyle="italic">
                                    <m:mrow>
                                      <m:mtext>πφσ</m:mtext>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mi fontstyle="italic">dσ</m:mi>
                        </m:mrow>
                      </m:mrow>
                      <m:mi fontstyle="italic">dτdδ</m:mi>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) = sqrt {E rSub { size 8{T} } }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {S \( τ,δ \) e rSup { size 8{j2 ital "πδσ"} } r \( σ - τ \) } } r rSup { size 8{*} }  \( σ - t \) e rSup { size 8{ - j2 ital "πφσ"} } dσ} dτdδ} {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10639841">Which equals</para>
        <para id="id11665763">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msqrt>
                          <m:msub>
                            <m:mi>E</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>T</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:msqrt>
                      </m:mrow>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∫</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mo stretchy="false">∞</m:mo>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:munderover>
                                <m:mo stretchy="false">∫</m:mo>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">−</m:mo>
                                      <m:mo stretchy="false">∞</m:mo>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mo stretchy="false">∞</m:mo>
                                  </m:mrow>
                                </m:mstyle>
                              </m:munderover>
                              <m:mrow>
                                <m:mi>S</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:mi>τ</m:mi>
                                <m:mi>,</m:mi>
                                <m:mi>δ</m:mi>
                                <m:mo stretchy="false">)</m:mo>
                                <m:msup>
                                  <m:mi>e</m:mi>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mrow>
                                        <m:mrow>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:mi fontstyle="italic">j2π</m:mi>
                                        </m:mrow>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:mi>φ</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:mi>δ</m:mi>
                                        </m:mrow>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mi>σ</m:mi>
                                      </m:mrow>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msup>
                                <m:mi>r</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:mrow>
                                  <m:mi>σ</m:mi>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mi>τ</m:mi>
                                </m:mrow>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mrow>
                          <m:msup>
                            <m:mi>r</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow/>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>σ</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>t</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi fontstyle="italic">dσ</m:mi>
                        </m:mrow>
                      </m:mrow>
                      <m:mi fontstyle="italic">dτdδ</m:mi>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) = sqrt {E rSub { size 8{T} } }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {S \( τ,δ \) e rSup { size 8{ - j2π \( φ - δ \) σ} } r \( σ - τ \) } } r rSup { size 8{*} }  \( σ - t \) dσ} dτdδ} {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11913305">Letting 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msup><m:mi>σ</m:mi><m:mi>'</m:mi></m:msup><m:mo stretchy="false">=</m:mo><m:mrow><m:mi>σ</m:mi><m:mo stretchy="false">−</m:mo><m:mi>t</m:mi></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ { {σ}} sup { ' }=σ - t} {}</m:annotation></m:semantics></m:math>, we obtain</para>
        <para id="id10930855">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msqrt>
                          <m:msub>
                            <m:mi>E</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>T</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:msqrt>
                      </m:mrow>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∫</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mo stretchy="false">∞</m:mo>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:munderover>
                                <m:mo stretchy="false">∫</m:mo>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">−</m:mo>
                                      <m:mo stretchy="false">∞</m:mo>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mo stretchy="false">∞</m:mo>
                                  </m:mrow>
                                </m:mstyle>
                              </m:munderover>
                              <m:mrow>
                                <m:mi>S</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:mi>τ</m:mi>
                                <m:mi>,</m:mi>
                                <m:mi>δ</m:mi>
                                <m:mo stretchy="false">)</m:mo>
                                <m:msup>
                                  <m:mi>e</m:mi>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mrow>
                                        <m:mrow>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:mi fontstyle="italic">j2π</m:mi>
                                        </m:mrow>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:mi>φ</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:mi>δ</m:mi>
                                        </m:mrow>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:msup>
                                            <m:mi>σ</m:mi>
                                            <m:mi>'</m:mi>
                                          </m:msup>
                                          <m:mo stretchy="false">+</m:mo>
                                          <m:mi>τ</m:mi>
                                        </m:mrow>
                                        <m:mo stretchy="false">)</m:mo>
                                      </m:mrow>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msup>
                                <m:mi>r</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:msup>
                                  <m:mi>σ</m:mi>
                                  <m:mi>'</m:mi>
                                </m:msup>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mrow>
                          <m:msup>
                            <m:mi>r</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow/>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:msup>
                              <m:mi>σ</m:mi>
                              <m:mi>'</m:mi>
                            </m:msup>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mo stretchy="false">(</m:mo>
                          </m:mrow>
                          <m:mrow>
                            <m:mi>t</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mi>τ</m:mi>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mo stretchy="false">)</m:mo>
                          <m:mi fontstyle="italic">dσ</m:mi>
                        </m:mrow>
                      </m:mrow>
                      <m:mi fontstyle="italic">dτdδ</m:mi>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) = sqrt {E rSub { size 8{T} } }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {S \( τ,δ \) e rSup { size 8{ - j2π \( φ - δ \)  \(  { {σ}} sup { ' }+τ \) } } r \(  { {σ}} sup { ' } \) } } r rSup { size 8{*} }  \(  { {σ}} sup { ' } -  \( t - τ \)  \) dσ} dτdδ} {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11619347">Using the definition of the narrowband ambiguity function, the matched filter response becomes</para>
        <para id="id11090890">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msqrt>
                          <m:msub>
                            <m:mi>E</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>T</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:msqrt>
                      </m:mrow>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:mi>S</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>τ</m:mi>
                            <m:mi>,</m:mi>
                            <m:mi>δ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:msup>
                              <m:mi>e</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">−</m:mo>
                                      <m:mi fontstyle="italic">j2π</m:mi>
                                    </m:mrow>
                                    <m:mo stretchy="false">(</m:mo>
                                    <m:mrow>
                                      <m:mi>φ</m:mi>
                                      <m:mo stretchy="false">−</m:mo>
                                      <m:mi>δ</m:mi>
                                    </m:mrow>
                                    <m:mo stretchy="false">)</m:mo>
                                    <m:mi>τ</m:mi>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                            <m:mi>χ</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>t</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>τ</m:mi>
                            </m:mrow>
                            <m:mi>,</m:mi>
                            <m:mrow>
                              <m:mi>φ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:mi>δ</m:mi>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi fontstyle="italic">dτdδ</m:mi>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) = sqrt {E rSub { size 8{T} } }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {S \( τ,δ \) e rSup { size 8{ - j2π \( φ - δ \) τ} } χ \( t - τ,φ - δ \) dτdδ} } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10106245">The response of the matched filter is a “twisted convolution” of the spreading function and the waveform ambiguity function. The exponential 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msup><m:mi>e</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mrow><m:mrow><m:mo stretchy="false">−</m:mo><m:mi fontstyle="italic">j2π</m:mi></m:mrow><m:mo stretchy="false">(</m:mo><m:mrow><m:mi>φ</m:mi><m:mo stretchy="false">−</m:mo><m:mi>δ</m:mi></m:mrow><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle></m:msup></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{e rSup { size 8{ - j2π \( φ - δ \) } } } {}</m:annotation></m:semantics></m:math>performs the twisting. Note that if the waveform ambiguity function was “perfect”, that is a single peak, </para>
        <para id="id11896508">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>χ</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>τ</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mi>δ</m:mi>
                      </m:mrow>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>τ</m:mi>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mi>δ</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>φ</m:mi>
                      <m:mo stretchy="false">)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{χ \( τ,φ \) =δ \( τ \) δ \( φ \) } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10960093">Then the matched filter response would become:</para>
        <para id="id10960098">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>m</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msqrt>
                          <m:msub>
                            <m:mi>E</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mi>T</m:mi>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:msqrt>
                      </m:mrow>
                      <m:mi>S</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">+</m:mo>
                        <m:mi>n</m:mi>
                      </m:mrow>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mo stretchy="false">)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{m \( t,φ \) = sqrt {E rSub { size 8{T} } } S \( t,φ \) +n \( t,φ \) } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10553868">Where 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>n</m:mi><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mi>,</m:mi><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{n \( t,φ \) } {}</m:annotation></m:semantics></m:math> is the response of the matched filter to ambient noise. In this sense, the matched filter is estimating the spreading function of the channel, with targets, clutter and reverberation all part of the spreading function. Note, however that 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>χ</m:mi><m:mo stretchy="false">(</m:mo><m:mn>0,0</m:mn><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:mn>1</m:mn></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{χ \( 0,0 \) =1} {}</m:annotation></m:semantics></m:math> , so the ambiguity function cannot become a delta function. </para>
        <para id="id11746109">Now, the power output of the matched filter is desired, so that Signal to Interference Ratios and similar quantities can be predicted. We will make statistical assumptions about the spreading function. The assumptions are that the spreading function is wide sense stationary and uncorrelated. This implies that the signals being processed are statistically stationary and that the scatterers are uncorrelated; so that (Van Trees, III, Ch 13):</para>
        <para id="id12143667">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>E</m:mi>
                      <m:mrow>
                        <m:mfenced open="{" close="}">
                          <m:mrow>
                            <m:mi>S</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>τ</m:mi>
                            <m:mi>,</m:mi>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mi>S</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:msup>
                              <m:mi>τ</m:mi>
                              <m:mi>'</m:mi>
                            </m:msup>
                            <m:mi>,</m:mi>
                            <m:msup>
                              <m:mi>φ</m:mi>
                              <m:mi>'</m:mi>
                            </m:msup>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                        </m:mfenced>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msub>
                          <m:mi>R</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mstyle fontstyle="italic">
                                <m:mrow>
                                  <m:mtext>SS</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>τ</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mi>δ</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mrow>
                        <m:mi>τ</m:mi>
                        <m:mo stretchy="false">−</m:mo>
                        <m:msup>
                          <m:mi>τ</m:mi>
                          <m:mi>'</m:mi>
                        </m:msup>
                      </m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mi>δ</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mrow>
                        <m:mi>φ</m:mi>
                        <m:mo stretchy="false">−</m:mo>
                        <m:msup>
                          <m:mi>φ</m:mi>
                          <m:mi>'</m:mi>
                        </m:msup>
                      </m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace S \( τ,φ \) S \(  { {τ}} sup { ' }, { {φ}} sup { ' } \)  right rbrace =R rSub { size 8{ ital "SS"} }  \( τ,φ \) δ \( τ -  { {τ}} sup { ' } \) δ \( φ -  { {φ}} sup { ' } \) } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id9920324"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msub><m:mi>R</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>SS</m:mtext></m:mrow></m:mstyle></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">(</m:mo><m:mi>τ</m:mi><m:mi>,</m:mi><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{R rSub { size 8{ ital "SS"} }  \( τ,φ \) } {}</m:annotation></m:semantics></m:math>is known as the scattering function of the active sonar scenario. The description of the target, reverberation and clutter statistics are captured in this expression.</para>
        <para id="id10554851">Using this definition, we obtain for the power of the matched filter:</para>
        <para id="id10554857">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mrow>
                  <m:mtable>
                    <m:mtr>
                      <m:mrow>
                        <m:mstyle fontsize="12pt">
                          <m:mrow>
                            <m:mrow>
                              <m:mi>E</m:mi>
                              <m:mrow>
                                <m:mfenced open="{" close="}">
                                  <m:mrow>
                                    <m:mi>m</m:mi>
                                    <m:mo stretchy="false">(</m:mo>
                                    <m:mi>t</m:mi>
                                    <m:mi>,</m:mi>
                                    <m:mi>φ</m:mi>
                                    <m:mo stretchy="false">)</m:mo>
                                    <m:msup>
                                      <m:mi>m</m:mi>
                                      <m:mstyle fontsize="8pt">
                                        <m:mrow>
                                          <m:mrow/>
                                        </m:mrow>
                                      </m:mstyle>
                                    </m:msup>
                                    <m:mo stretchy="false">(</m:mo>
                                    <m:mi>t</m:mi>
                                    <m:mi>,</m:mi>
                                    <m:mi>φ</m:mi>
                                    <m:mo stretchy="false">)</m:mo>
                                  </m:mrow>
                                </m:mfenced>
                                <m:mo stretchy="false">=</m:mo>
                                <m:mrow/>
                              </m:mrow>
                            </m:mrow>
                          </m:mrow>
                        </m:mstyle>
                        <m:mrow/>
                      </m:mrow>
                    </m:mtr>
                    <m:mtr>
                      <m:mrow>
                        <m:msub>
                          <m:mi>E</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∫</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mo stretchy="false">∞</m:mo>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:mi>S</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mi>τ</m:mi>
                              <m:mi>,</m:mi>
                              <m:mi>δ</m:mi>
                              <m:mo stretchy="false">)</m:mo>
                              <m:msup>
                                <m:mi>e</m:mi>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mrow>
                                        <m:mo stretchy="false">−</m:mo>
                                        <m:mi fontstyle="italic">j2π</m:mi>
                                      </m:mrow>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mrow>
                                        <m:mi>φ</m:mi>
                                        <m:mo stretchy="false">−</m:mo>
                                        <m:mi>δ</m:mi>
                                      </m:mrow>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:mi>τ</m:mi>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msup>
                              <m:mi>χ</m:mi>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>t</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>τ</m:mi>
                              </m:mrow>
                              <m:mi>,</m:mi>
                              <m:mrow>
                                <m:mi>φ</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mi>δ</m:mi>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi fontstyle="italic">dτdδ</m:mi>
                            </m:mrow>
                          </m:mrow>
                        </m:mrow>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:munderover>
                              <m:mo stretchy="false">∫</m:mo>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mo stretchy="false">∞</m:mo>
                                  </m:mrow>
                                </m:mrow>
                              </m:mstyle>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mstyle>
                            </m:munderover>
                            <m:mrow>
                              <m:msup>
                                <m:mi>S</m:mi>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mrow/>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msup>
                              <m:mo stretchy="false">(</m:mo>
                              <m:msup>
                                <m:mi>τ</m:mi>
                                <m:mi>'</m:mi>
                              </m:msup>
                              <m:mi>,</m:mi>
                              <m:msup>
                                <m:mi>δ</m:mi>
                                <m:mi>'</m:mi>
                              </m:msup>
                              <m:mo stretchy="false">)</m:mo>
                              <m:msup>
                                <m:mi>e</m:mi>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mi fontstyle="italic">j2π</m:mi>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mrow>
                                        <m:mi>φ</m:mi>
                                        <m:mo stretchy="false">−</m:mo>
                                        <m:msup>
                                          <m:mi>δ</m:mi>
                                          <m:mi>'</m:mi>
                                        </m:msup>
                                      </m:mrow>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:msup>
                                        <m:mi>τ</m:mi>
                                        <m:mi>'</m:mi>
                                      </m:msup>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msup>
                              <m:msup>
                                <m:mi>χ</m:mi>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mrow/>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msup>
                              <m:mo stretchy="false">(</m:mo>
                              <m:mrow>
                                <m:mi>t</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:msup>
                                  <m:mi>τ</m:mi>
                                  <m:mi>'</m:mi>
                                </m:msup>
                              </m:mrow>
                              <m:mi>,</m:mi>
                              <m:mrow>
                                <m:mi>φ</m:mi>
                                <m:mo stretchy="false">−</m:mo>
                                <m:msup>
                                  <m:mi>δ</m:mi>
                                  <m:mi>'</m:mi>
                                </m:msup>
                              </m:mrow>
                              <m:mo stretchy="false">)</m:mo>
                              <m:mi>d</m:mi>
                              <m:msup>
                                <m:mi>τ</m:mi>
                                <m:mi>'</m:mi>
                              </m:msup>
                              <m:mi>d</m:mi>
                              <m:msup>
                                <m:mi>δ</m:mi>
                                <m:mi>'</m:mi>
                              </m:msup>
                            </m:mrow>
                          </m:mrow>
                        </m:mrow>
                        <m:mrow/>
                      </m:mrow>
                    </m:mtr>
                  </m:mtable>
                  <m:mrow/>
                </m:mrow>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0">alignl { stack {
 size 12{E left lbrace m \( t,φ \) m rSup { size 8{*} }  \( t,φ \)  right rbrace ={}}  {} # 
E rSub { size 8{T} }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {S \( τ,δ \) e rSup { size 8{ - j2π \( φ - δ \) τ} } χ \( t - τ,φ - δ \) dτdδ} }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {S rSup { size 8{*} }  \(  { {τ}} sup { ' }, { {δ}} sup { ' } \) e rSup { size 8{j2π \( φ -  { {δ}} sup { ' } \)  { {τ}} sup { ' }} } χ rSup { size 8{*} }  \( t -  { {τ}} sup { ' },φ -  { {δ}} sup { ' } \) d { {τ}} sup { ' }d { {δ}} sup { ' }} }  {} 
} } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10123089">Which becomes</para>
        <para id="id10518426">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>E</m:mi>
                      <m:mrow>
                        <m:mfenced open="{" close="}">
                          <m:msup>
                            <m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                              <m:mrow>
                                <m:mi>m</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:mi>t</m:mi>
                                <m:mi>,</m:mi>
                                <m:mi>φ</m:mi>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                            </m:mrow>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                        </m:mfenced>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msub>
                          <m:mi>E</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                      <m:mrow>
                        <m:munderover>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mo stretchy="false">−</m:mo>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mo stretchy="false">∞</m:mo>
                            </m:mrow>
                          </m:mstyle>
                        </m:munderover>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">−</m:mo>
                                  <m:mo stretchy="false">∞</m:mo>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mo stretchy="false">∞</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:msub>
                              <m:mi>R</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mstyle fontstyle="italic">
                                    <m:mrow>
                                      <m:mtext>SS</m:mtext>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>τ</m:mi>
                            <m:mi>,</m:mi>
                            <m:mi>δ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                            <m:msup>
                              <m:mrow>
                                <m:mo stretchy="false">∣</m:mo>
                                <m:mrow>
                                  <m:mi>χ</m:mi>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:mrow>
                                    <m:mi>t</m:mi>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mi>τ</m:mi>
                                  </m:mrow>
                                  <m:mi>,</m:mi>
                                  <m:mrow>
                                    <m:mi>φ</m:mi>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mi>δ</m:mi>
                                  </m:mrow>
                                  <m:mo stretchy="false">)</m:mo>
                                </m:mrow>
                                <m:mo stretchy="false">∣</m:mo>
                              </m:mrow>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mn>2</m:mn>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                            <m:mi fontstyle="italic">dτdδ</m:mi>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{E left lbrace  lline m \( t,φ \)  rline  rSup { size 8{2} }  right rbrace =E rSub { size 8{T} }  Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  { Int cSub { size 8{ -  infinity } }  cSup { size 8{ infinity } }  {R rSub { size 8{ ital "SS"} }  \( τ,δ \)  lline χ \( t - τ,φ - δ \)  rline  rSup { size 8{2} } dτdδ} } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11101680">Using two dimensional convolution notation **, this expression for the matched filter power 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>P</m:mi><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mi>,</m:mi><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{P \( t,φ \) } {}</m:annotation></m:semantics></m:math> becomes</para>
        <para id="id10588216">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>P</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mi>E</m:mi>
                      </m:mrow>
                      <m:mrow>
                        <m:mfenced open="{" close="}">
                          <m:msup>
                            <m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                              <m:mrow>
                                <m:mi>m</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:mi>t</m:mi>
                                <m:mi>,</m:mi>
                                <m:mi>φ</m:mi>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                            </m:mrow>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                        </m:mfenced>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msub>
                          <m:mi>E</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>T</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                      <m:msub>
                        <m:mi>R</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mstyle fontstyle="italic">
                              <m:mrow>
                                <m:mtext>SS</m:mtext>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mtext>**</m:mtext>
                      <m:msup>
                        <m:mrow>
                          <m:mo stretchy="false">∣</m:mo>
                          <m:mrow>
                            <m:mi>χ</m:mi>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>t</m:mi>
                            <m:mi>,</m:mi>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                          <m:mo stretchy="false">∣</m:mo>
                        </m:mrow>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>2</m:mn>
                          </m:mrow>
                        </m:mstyle>
                      </m:msup>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{P \( t,φ \) =E left lbrace  lline m \( t,φ \)  rline  rSup { size 8{2} }  right rbrace =E rSub { size 8{T} } R rSub { size 8{ ital "SS"} }  \( t,φ \) "**" lline χ \( t,φ \)  rline  rSup { size 8{2} } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10057495">Now, let us model the acoustic sonar problem as target, clutter/reverberation and noise. The matched filter power response to ambient noise was shown earlier to be 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>. The overall signal to interference ratio, for a target at range 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>t</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{t} {}</m:annotation></m:semantics></m:math>and Doppler 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>φ</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{φ} {}</m:annotation></m:semantics></m:math> is</para>
        <para id="id10218584">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>SIR</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mfrac>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mtext>Target</m:mtext>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>φ</m:mi>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mtext>Reverb/clutter</m:mtext>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mi>t</m:mi>
                          <m:mi>,</m:mi>
                          <m:mi>φ</m:mi>
                          <m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                            <m:mo stretchy="false">+</m:mo>
                            <m:mstyle fontstyle="italic">
                              <m:mrow>
                                <m:msub>
                                  <m:mtext>AN</m:mtext>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mn>0</m:mn>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msub>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                        </m:mrow>
                      </m:mfrac>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{ ital "SIR"= {  {P rSub { size 8{"Target"} }  \( t,φ \) }  over  {P rSub { size 8{"Reverb/clutter"} }  \( t,φ \) + ital "AN" rSub { size 8{0} } } } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10299573">Which becomes, </para>
        <para id="id10685996">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>SIR</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mfrac>
                          <m:mrow>
                            <m:msubsup>
                              <m:mi>R</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:msub>
                                    <m:mrow/>
                                    <m:mstyle fontsize="6pt">
                                      <m:mrow>
                                        <m:mstyle fontstyle="italic">
                                          <m:mrow>
                                            <m:mtext>SS</m:mtext>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:msub>
                                </m:mrow>
                              </m:mstyle>
                              <m:mtext>Target</m:mtext>
                            </m:msubsup>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:mi>t</m:mi>
                                  <m:mi>,</m:mi>
                                  <m:mi>φ</m:mi>
                                  <m:mo stretchy="false">)</m:mo>
                                  <m:mtext>**</m:mtext>
                                  <m:msup>
                                    <m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                      <m:mrow>
                                        <m:mi>χ</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mi>t</m:mi>
                                        <m:mi>,</m:mi>
                                        <m:mi>φ</m:mi>
                                        <m:mo stretchy="false">)</m:mo>
                                      </m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                    </m:mrow>
                                    <m:mn>2</m:mn>
                                  </m:msup>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                          <m:mstyle fontsize="12pt">
                            <m:mrow>
                              <m:mrow>
                                <m:msubsup>
                                  <m:mi>R</m:mi>
                                  <m:msub>
                                    <m:mrow/>
                                    <m:mstyle fontsize="6pt">
                                      <m:mrow>
                                        <m:mstyle fontstyle="italic">
                                          <m:mrow>
                                            <m:mtext>SS</m:mtext>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:msub>
                                  <m:mtext>Reverb/Clutter</m:mtext>
                                </m:msubsup>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mi>t</m:mi>
                                      <m:mi>,</m:mi>
                                      <m:mi>φ</m:mi>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:mtext>**</m:mtext>
                                      <m:msup>
                                        <m:mrow>
                                          <m:mo stretchy="false">∣</m:mo>
                                          <m:mrow>
                                            <m:mi>χ</m:mi>
                                            <m:mo stretchy="false">(</m:mo>
                                            <m:mi>t</m:mi>
                                            <m:mi>,</m:mi>
                                            <m:mi>φ</m:mi>
                                            <m:mo stretchy="false">)</m:mo>
                                          </m:mrow>
                                          <m:mo stretchy="false">∣</m:mo>
                                        </m:mrow>
                                        <m:mn>2</m:mn>
                                      </m:msup>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">+</m:mo>
                                      <m:mfrac>
                                        <m:mstyle fontstyle="italic">
                                          <m:mrow>
                                            <m:msub>
                                              <m:mtext>AN</m:mtext>
                                              <m:mn>0</m:mn>
                                            </m:msub>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:msub>
                                              <m:mi>E</m:mi>
                                              <m:mi>T</m:mi>
                                            </m:msub>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mfrac>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:mfrac>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{ ital "SIR" \( t,φ \) = {  {R rSub { size 8{ {} rSub { size 6{ ital "SS"} } } }  rSup {"Target"}  size 12{ \( t,φ \) "**" lline χ \( t,φ \)  rline  rSup {2} }}  over  { size 12{R rSub { {} rSub { size 6{ ital "SS"} } }  rSup {"Reverb/Clutter"}  size 12{ \( t,φ \) "**" lline χ \( t,φ \)  rline  rSup {2} } size 12{+ {  { ital "AN" rSub {0} }  over  { size 12{E rSub {T} } } } }} } } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11671117">This expression can be simplified for different target and scattering conditions. For a point target at range 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>t</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{t rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>and Doppler 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>φ</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{φ rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>, the target scattering function becomes</para>
        <para id="id9188837"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msubsup><m:mi>R</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>SS</m:mtext></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mstyle fontsize="8pt"><m:mrow><m:mtext>Target</m:mtext></m:mrow></m:mstyle></m:msubsup><m:mo stretchy="false">(</m:mo><m:mi>t</m:mi><m:mi>,</m:mi><m:mi>φ</m:mi><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:mi fontstyle="italic">Sδ</m:mi></m:mrow><m:mo stretchy="false">(</m:mo><m:mrow><m:mi>t</m:mi><m:mo stretchy="false">−</m:mo><m:msub><m:mi>t</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow><m:mo stretchy="false">)</m:mo><m:mi>δ</m:mi><m:mo stretchy="false">(</m:mo><m:mrow><m:mi>φ</m:mi><m:mo stretchy="false">−</m:mo><m:msub><m:mi>φ</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{R rSub { size 8{ ital "SS"} }  rSup { size 8{"Target"} }  \( t,φ \) =Sδ \( t - t rSub { size 8{0} }  \) δ \( φ - φ rSub { size 8{0} }  \) } {}</m:annotation></m:semantics></m:math>.</para>
        <para id="id6871998">Often, we can assume that the reverberation scattering function is constant in the vicinity of the target, so that</para>
        <para id="id11899520">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:msubsup>
                        <m:mi>R</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mstyle fontstyle="italic">
                              <m:mrow>
                                <m:mtext>SS</m:mtext>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                        </m:mstyle>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mtext>Reverb/Clutter</m:mtext>
                          </m:mrow>
                        </m:mstyle>
                      </m:msubsup>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msub>
                          <m:mi>R</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:msub>
                                <m:mi>t</m:mi>
                                <m:mstyle fontsize="6pt">
                                  <m:mrow>
                                    <m:mn>0</m:mn>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msub>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                      <m:msub>
                        <m:mi>Q</m:mi>
                        <m:mtext>Revrb</m:mtext>
                      </m:msub>
                      <m:mstyle fontsize="12pt">
                        <m:mrow>
                          <m:mrow>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                        </m:mrow>
                      </m:mstyle>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{R rSub { size 8{ ital "SS"} }  rSup { size 8{"Reverb/Clutter"} }  \( t,φ \) =R rSub { size 8{t rSub { size 6{0} } } } Q rSub {"Revrb"}  size 12{ \( φ \) }} {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10907630"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msub><m:mi>Q</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mtext>Revrb</m:mtext></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">(</m:mo><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Q rSub { size 8{"Revrb"} }  \( φ \) } {}</m:annotation></m:semantics></m:math> describes the Doppler roll-off of the reverberation. It will be affected by the source, receiver and ocean motion. In this characterization, we are ignoring “discrete clutter”, e.g. target like responses from bottom features. </para>
        <para id="id10668795">We will assume that 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:msub><m:mi>Q</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mtext>Revrb</m:mtext></m:mrow></m:mstyle></m:msub><m:mo stretchy="false">(</m:mo><m:mi>φ</m:mi><m:mo stretchy="false">)</m:mo></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Q rSub { size 8{"Revrb"} }  \( φ \) } {}</m:annotation></m:semantics></m:math>is normalized, so that:</para>
        <para id="id4506025">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mo stretchy="false">∫</m:mo>
                      <m:mrow>
                        <m:msub>
                          <m:mi>Q</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mtext>Revrb</m:mtext>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                        <m:mo stretchy="false">(</m:mo>
                        <m:mi>φ</m:mi>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mrow>
                          <m:mi fontstyle="italic">dφ</m:mi>
                          <m:mo stretchy="false">=</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{ Int {Q rSub { size 8{"Revrb"} }  \( φ \) dφ=1} } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id9975702">With these assumptions we obtain</para>
        <para id="id9975706">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>SIR</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mfrac>
                          <m:mrow>
                            <m:msup>
                              <m:mi>S</m:mi>
                              <m:mtext>Target</m:mtext>
                            </m:msup>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:msub>
                                    <m:mi>t</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>,</m:mi>
                                  <m:msub>
                                    <m:mi>φ</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">)</m:mo>
                                  <m:msup>
                                    <m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                      <m:mrow>
                                        <m:mi>χ</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:mi>t</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:msub>
                                            <m:mi>t</m:mi>
                                            <m:mn>0</m:mn>
                                          </m:msub>
                                        </m:mrow>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mrow>
                                              <m:mi>,</m:mi>
                                              <m:mrow>
                                                <m:mi>φ</m:mi>
                                                <m:mo stretchy="false">−</m:mo>
                                                <m:msub>
                                                  <m:mi>φ</m:mi>
                                                  <m:mn>0</m:mn>
                                                </m:msub>
                                              </m:mrow>
                                            </m:mrow>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mo stretchy="false">)</m:mo>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                    </m:mrow>
                                    <m:mn>2</m:mn>
                                  </m:msup>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                          <m:mstyle fontsize="12pt">
                            <m:mrow>
                              <m:mrow>
                                <m:msub>
                                  <m:mi>R</m:mi>
                                  <m:msub>
                                    <m:mrow/>
                                    <m:mstyle fontsize="6pt">
                                      <m:mrow>
                                        <m:msub>
                                          <m:mi>t</m:mi>
                                          <m:mn>0</m:mn>
                                        </m:msub>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:msub>
                                </m:msub>
                                <m:mrow>
                                  <m:mo stretchy="false">∬</m:mo>
                                  <m:mrow/>
                                </m:mrow>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:msub>
                                      <m:mi>Q</m:mi>
                                      <m:mtext>Reverb</m:mtext>
                                    </m:msub>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mrow>
                                        <m:mi>φ</m:mi>
                                        <m:mo stretchy="false">−</m:mo>
                                        <m:mi>δ</m:mi>
                                      </m:mrow>
                                      <m:mo stretchy="false">)</m:mo>
                                      <m:msup>
                                        <m:mrow>
                                          <m:mo stretchy="false">∣</m:mo>
                                          <m:mrow>
                                            <m:mi>χ</m:mi>
                                            <m:mo stretchy="false">(</m:mo>
                                            <m:mi>τ</m:mi>
                                            <m:mi>,</m:mi>
                                            <m:mi>φ</m:mi>
                                            <m:mo stretchy="false">)</m:mo>
                                          </m:mrow>
                                          <m:mo stretchy="false">∣</m:mo>
                                        </m:mrow>
                                        <m:mn>2</m:mn>
                                      </m:msup>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mi fontstyle="italic">dτdδ</m:mi>
                                      <m:mo stretchy="false">+</m:mo>
                                      <m:mfrac>
                                        <m:mstyle fontstyle="italic">
                                          <m:mrow>
                                            <m:msub>
                                              <m:mtext>AN</m:mtext>
                                              <m:mn>0</m:mn>
                                            </m:msub>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:msub>
                                              <m:mi>E</m:mi>
                                              <m:mi>T</m:mi>
                                            </m:msub>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mfrac>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:mfrac>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{ ital "SIR" \( t,φ \) = {  {S rSup {"Target"}  size 12{ \( t rSub {0} } size 12{,φ rSub {0} } size 12{ \)  lline χ \( t - t rSub {0}  size 12{,φ - φ rSub {0} } size 12{ \) } rline  rSup {2} }}  over  { size 12{R rSub { {} rSub { size 6{t rSub {0} } } }  iInt {}  size 12{Q rSub {"Reverb"} } size 12{ \( φ - δ \)  lline χ \( τ,φ \)  rline  rSup {2} } size 12{dτdδ+ {  { ital "AN" rSub {0} }  over  { size 12{E rSub {T} } } } }} } } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id12155472">Note that when the matched filter is matched in time and Doppler, then 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>t</m:mi><m:mo stretchy="false">=</m:mo><m:msub><m:mi>t</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{t=t rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>and 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mi>φ</m:mi><m:mo stretchy="false">=</m:mo><m:msub><m:mi>φ</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{φ=φ rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>, and the numerator is maximized:</para>
        <para id="id4064217">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>SIR</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">(</m:mo>
                      <m:msub>
                        <m:mi>t</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                      <m:mi>,</m:mi>
                      <m:msub>
                        <m:mi>φ</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mn>0</m:mn>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mfrac>
                          <m:mrow>
                            <m:msup>
                              <m:mi>S</m:mi>
                              <m:mtext>Target</m:mtext>
                            </m:msup>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:msub>
                                    <m:mi>t</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>,</m:mi>
                                  <m:msub>
                                    <m:mi>φ</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                          <m:mrow>
                            <m:msub>
                              <m:mi>R</m:mi>
                              <m:msub>
                                <m:mrow/>
                                <m:mstyle fontsize="6pt">
                                  <m:mrow>
                                    <m:msub>
                                      <m:mi>t</m:mi>
                                      <m:mn>0</m:mn>
                                    </m:msub>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msub>
                            </m:msub>
                            <m:mrow>
                              <m:mo stretchy="false">∬</m:mo>
                              <m:mrow/>
                            </m:mrow>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:msub>
                                  <m:mi>Q</m:mi>
                                  <m:mtext>Reverb</m:mtext>
                                </m:msub>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:msub>
                                    <m:mi>φ</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mi>δ</m:mi>
                                  </m:mrow>
                                  <m:mo stretchy="false">)</m:mo>
                                  <m:msup>
                                    <m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                      <m:mrow>
                                        <m:mi>χ</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mi>τ</m:mi>
                                        <m:mi>,</m:mi>
                                        <m:msub>
                                          <m:mi>φ</m:mi>
                                          <m:mn>0</m:mn>
                                        </m:msub>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mo stretchy="false">)</m:mo>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                    </m:mrow>
                                    <m:mn>2</m:mn>
                                  </m:msup>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi fontstyle="italic">dτdδ</m:mi>
                                  <m:mo stretchy="false">+</m:mo>
                                  <m:mfrac>
                                    <m:mstyle fontstyle="italic">
                                      <m:mrow>
                                        <m:msub>
                                          <m:mtext>AN</m:mtext>
                                          <m:mn>0</m:mn>
                                        </m:msub>
                                      </m:mrow>
                                    </m:mstyle>
                                    <m:mstyle fontsize="12pt">
                                      <m:mrow>
                                        <m:msub>
                                          <m:mi>E</m:mi>
                                          <m:mi>T</m:mi>
                                        </m:msub>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:mfrac>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                        </m:mfrac>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{ ital "SIR" \( t rSub { size 8{0} } ,φ rSub { size 8{0} }  \) = {  {S rSup {"Target"}  size 12{ \( t rSub {0} } size 12{,φ rSub {0} } size 12{ \) }}  over  {R rSub { {} rSub { size 6{t rSub {0} } } }  iInt {}  size 12{Q rSub {"Reverb"} } size 12{ \( φ rSub {0} } size 12{ - δ \)  lline χ \( τ,φ rSub {0}  size 12{ \) } rline  rSup {2} } size 12{dτdδ+ {  { ital "AN" rSub {0} }  over  { size 12{E rSub {T} } } } }} } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10595184">The denominator can be simplified further by using the definition of the waveform Q function:</para>
        <para id="id11418446">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mi>Q</m:mi>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mrow>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:msup>
                            <m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                              <m:mrow>
                                <m:mi>χ</m:mi>
                                <m:mo stretchy="false">(</m:mo>
                                <m:mi>τ</m:mi>
                                <m:mi>,</m:mi>
                                <m:mi>φ</m:mi>
                                <m:mo stretchy="false">)</m:mo>
                              </m:mrow>
                              <m:mo stretchy="false">∣</m:mo>
                            </m:mrow>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>2</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msup>
                        </m:mrow>
                      </m:mrow>
                      <m:mi fontstyle="italic">dτ</m:mi>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{Q \( φ \) = Int { lline χ \( τ,φ \)  rline }  rSup { size 8{2} } dτ} {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11150078">Using this definition, we obtain:</para>
        <para id="id11150082">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>SIR</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mfrac>
                          <m:mrow>
                            <m:msup>
                              <m:mi>S</m:mi>
                              <m:mtext>Target</m:mtext>
                            </m:msup>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:msub>
                                    <m:mi>t</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>,</m:mi>
                                  <m:msub>
                                    <m:mi>φ</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">)</m:mo>
                                  <m:msup>
                                    <m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                      <m:mrow>
                                        <m:mi>χ</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:mi>t</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:msub>
                                            <m:mi>t</m:mi>
                                            <m:mn>0</m:mn>
                                          </m:msub>
                                        </m:mrow>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mrow>
                                              <m:mi>,</m:mi>
                                              <m:mrow>
                                                <m:mi>φ</m:mi>
                                                <m:mo stretchy="false">−</m:mo>
                                                <m:msub>
                                                  <m:mi>φ</m:mi>
                                                  <m:mn>0</m:mn>
                                                </m:msub>
                                              </m:mrow>
                                            </m:mrow>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mo stretchy="false">)</m:mo>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                    </m:mrow>
                                    <m:mn>2</m:mn>
                                  </m:msup>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                          <m:mstyle fontsize="12pt">
                            <m:mrow>
                              <m:mrow>
                                <m:msub>
                                  <m:mi>R</m:mi>
                                  <m:msub>
                                    <m:mrow/>
                                    <m:mstyle fontsize="6pt">
                                      <m:mrow>
                                        <m:msub>
                                          <m:mi>t</m:mi>
                                          <m:mn>0</m:mn>
                                        </m:msub>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:msub>
                                </m:msub>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:msub>
                                      <m:mi>Q</m:mi>
                                      <m:mtext>Reverb</m:mtext>
                                    </m:msub>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mi>φ</m:mi>
                                      <m:mrow>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mo stretchy="false">∗</m:mo>
                                        <m:mi>Q</m:mi>
                                      </m:mrow>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mi>φ</m:mi>
                                      <m:mrow>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mo stretchy="false">+</m:mo>
                                        <m:mfrac>
                                          <m:mstyle fontstyle="italic">
                                            <m:mrow>
                                              <m:msub>
                                                <m:mtext>AN</m:mtext>
                                                <m:mn>0</m:mn>
                                              </m:msub>
                                            </m:mrow>
                                          </m:mstyle>
                                          <m:mstyle fontsize="12pt">
                                            <m:mrow>
                                              <m:msub>
                                                <m:mi>E</m:mi>
                                                <m:mi>T</m:mi>
                                              </m:msub>
                                            </m:mrow>
                                          </m:mstyle>
                                        </m:mfrac>
                                      </m:mrow>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:mfrac>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{ ital "SIR" \( t,φ \) = {  {S rSup {"Target"}  size 12{ \( t rSub {0} } size 12{,φ rSub {0} } size 12{ \)  lline χ \( t - t rSub {0}  size 12{,φ - φ rSub {0} } size 12{ \) } rline  rSup {2} }}  over  { size 12{R rSub { {} rSub { size 6{t rSub {0} } } }  size 12{Q rSub {"Reverb"} } size 12{ \( φ \) *Q \( φ \) + {  { ital "AN" rSub {0} }  over  { size 12{E rSub {T} } } } }} } } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10532407">When using a waveform with a Q function much wider than the reverberation Q function, (such as an HFM), the waveform Q function can be replaced by a constant, such as 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>Q</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>HFM</m:mtext></m:mrow></m:mstyle></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Q rSub { size 8{ ital "HFM"} } } {}</m:annotation></m:semantics></m:math>. The convolution with the reverberation Q function becomes the constant 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>Q</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>HFM</m:mtext></m:mrow></m:mstyle></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Q rSub { size 8{ ital "HFM"} } } {}</m:annotation></m:semantics></m:math>(because of the normalization of 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:msub><m:mi>Q</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mtext>Reverb</m:mtext></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{Q rSub { size 8{"Reverb"} } } {}</m:annotation></m:semantics></m:math>) :</para>
        <para id="id11610802">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:msub>
                        <m:mi>Q</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mtext>Reverb</m:mtext>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">∗</m:mo>
                        <m:mi>Q</m:mi>
                      </m:mrow>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msub>
                          <m:mi>Q</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mstyle fontstyle="italic">
                                <m:mrow>
                                  <m:mtext>HFM</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                      <m:mrow>
                        <m:mo stretchy="false">∫</m:mo>
                        <m:mrow>
                          <m:msub>
                            <m:mi>Q</m:mi>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mtext>Reverb</m:mtext>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                          <m:mo stretchy="false">(</m:mo>
                          <m:mrow>
                            <m:mi>φ</m:mi>
                            <m:mo stretchy="false">−</m:mo>
                            <m:msup>
                              <m:mi>φ</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mi>'</m:mi>
                                </m:mrow>
                              </m:mstyle>
                            </m:msup>
                          </m:mrow>
                          <m:mo stretchy="false">)</m:mo>
                        </m:mrow>
                      </m:mrow>
                      <m:mrow>
                        <m:msup>
                          <m:mi fontstyle="italic">dφ</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>'</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">=</m:mo>
                        <m:msub>
                          <m:mi>Q</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mstyle fontstyle="italic">
                                <m:mrow>
                                  <m:mtext>HFM</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{Q rSub { size 8{"Reverb"} }  \( φ \) *Q \( φ \) =Q rSub { size 8{ ital "HFM"} }  Int {Q rSub { size 8{"Reverb"} }  \( φ - φ rSup { size 8{'} }  \) } dφ rSup { size 8{'} } =Q rSub { size 8{ ital "HFM"} } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11518996">With this approximation the signal to interference ratio becomes:</para>
        <para id="id11519000">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:msub>
                            <m:mtext>SIR</m:mtext>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mstyle fontstyle="italic">
                                  <m:mrow>
                                    <m:mtext>HFM</m:mtext>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mfrac>
                          <m:mrow>
                            <m:msup>
                              <m:mi>S</m:mi>
                              <m:mtext>Target</m:mtext>
                            </m:msup>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:msub>
                                    <m:mi>t</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>,</m:mi>
                                  <m:msub>
                                    <m:mi>φ</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">)</m:mo>
                                  <m:msup>
                                    <m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                      <m:mrow>
                                        <m:mi>χ</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:mi>t</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:msub>
                                            <m:mi>t</m:mi>
                                            <m:mn>0</m:mn>
                                          </m:msub>
                                        </m:mrow>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mrow>
                                              <m:mi>,</m:mi>
                                              <m:mrow>
                                                <m:mi>φ</m:mi>
                                                <m:mo stretchy="false">−</m:mo>
                                                <m:msub>
                                                  <m:mi>φ</m:mi>
                                                  <m:mn>0</m:mn>
                                                </m:msub>
                                              </m:mrow>
                                            </m:mrow>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mo stretchy="false">)</m:mo>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                    </m:mrow>
                                    <m:mn>2</m:mn>
                                  </m:msup>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                          <m:mstyle fontsize="12pt">
                            <m:mrow>
                              <m:mrow>
                                <m:msub>
                                  <m:mi>R</m:mi>
                                  <m:msub>
                                    <m:mrow/>
                                    <m:mstyle fontsize="6pt">
                                      <m:mrow>
                                        <m:msub>
                                          <m:mi>t</m:mi>
                                          <m:mn>0</m:mn>
                                        </m:msub>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:msub>
                                </m:msub>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:msub>
                                      <m:mi>Q</m:mi>
                                      <m:mstyle fontstyle="italic">
                                        <m:mrow>
                                          <m:mtext>HFM</m:mtext>
                                        </m:mrow>
                                      </m:mstyle>
                                    </m:msub>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">+</m:mo>
                                      <m:mfrac>
                                        <m:mstyle fontstyle="italic">
                                          <m:mrow>
                                            <m:msub>
                                              <m:mtext>AN</m:mtext>
                                              <m:mn>0</m:mn>
                                            </m:msub>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:msub>
                                              <m:mi>E</m:mi>
                                              <m:mi>T</m:mi>
                                            </m:msub>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mfrac>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:mfrac>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{ ital "SIR" rSub { size 8{ ital "HFM"} }  \( t,φ \) = {  {S rSup {"Target"}  size 12{ \( t rSub {0} } size 12{,φ rSub {0} } size 12{ \)  lline χ \( t - t rSub {0}  size 12{,φ - φ rSub {0} } size 12{ \) } rline  rSup {2} }}  over  { size 12{R rSub { {} rSub { size 6{t rSub {0} } } }  size 12{Q rSub { ital "HFM"} } size 12{+ {  { ital "AN" rSub {0} }  over  { size 12{E rSub {T} } } } }} } } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id10930727">When the waveform is Doppler sensitive, and it’s Q function is narrower than the Reverberation Q function, we can approximate the waveform Q function by a rectangle of height T and width 1/T centered at zero Doppler. Than the convolution becomes:</para>
        <para id="id9457143">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:msub>
                        <m:mi>Q</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mtext>Reverb</m:mtext>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">∗</m:mo>
                        <m:mi>Q</m:mi>
                      </m:mrow>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mrow>
                          <m:mo stretchy="false">∫</m:mo>
                          <m:mrow>
                            <m:msub>
                              <m:mi>Q</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mtext>Reverb</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>φ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:msup>
                                <m:mi>φ</m:mi>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mi>'</m:mi>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msup>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                      <m:msub>
                        <m:mi>Q</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mstyle fontstyle="italic">
                              <m:mrow>
                                <m:mtext>DSW</m:mtext>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                        </m:mstyle>
                      </m:msub>
                      <m:mo stretchy="false">(</m:mo>
                      <m:msup>
                        <m:mi>φ</m:mi>
                        <m:mstyle fontsize="8pt">
                          <m:mrow>
                            <m:mi>'</m:mi>
                          </m:mrow>
                        </m:mstyle>
                      </m:msup>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mrow>
                        <m:msup>
                          <m:mi fontstyle="italic">dφ</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>'</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">≈</m:mo>
                        <m:mrow>
                          <m:munderover>
                            <m:mo stretchy="false">∫</m:mo>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mrow>
                                    <m:mo stretchy="false">−</m:mo>
                                    <m:mn>1</m:mn>
                                  </m:mrow>
                                  <m:mo stretchy="false">/</m:mo>
                                  <m:mn>2T</m:mn>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mn>1</m:mn>
                                  <m:mo stretchy="false">/</m:mo>
                                  <m:mn>2T</m:mn>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:munderover>
                          <m:mrow>
                            <m:msub>
                              <m:mi>Q</m:mi>
                              <m:mstyle fontsize="8pt">
                                <m:mrow>
                                  <m:mtext>Reverb</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                            </m:msub>
                            <m:mo stretchy="false">(</m:mo>
                            <m:mrow>
                              <m:mi>φ</m:mi>
                              <m:mo stretchy="false">−</m:mo>
                              <m:msup>
                                <m:mi>φ</m:mi>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mi>'</m:mi>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msup>
                            </m:mrow>
                            <m:mo stretchy="false">)</m:mo>
                          </m:mrow>
                        </m:mrow>
                      </m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>Td</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                      <m:mrow>
                        <m:msup>
                          <m:mi>φ</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mi>'</m:mi>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">≈</m:mo>
                        <m:msub>
                          <m:mi>Q</m:mi>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mtext>Re</m:mtext>
                                <m:mstyle fontstyle="italic">
                                  <m:mrow>
                                    <m:mtext>verb</m:mtext>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>φ</m:mi>
                      <m:mo stretchy="false">)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{Q rSub { size 8{"Reverb"} }  \( φ \) *Q \( φ \) = Int {Q rSub { size 8{"Reverb"} }  \( φ - φ rSup { size 8{'} }  \) } Q rSub { size 8{ ital "DSW"} }  \( φ rSup { size 8{'} }  \) dφ rSup { size 8{'} }  approx  Int cSub { size 8{ - 1/2T} }  cSup { size 8{1/2T} }  {Q rSub { size 8{"Reverb"} }  \( φ - φ rSup { size 8{'} }  \) }  ital "Td"φ rSup { size 8{'} }  approx Q rSub { size 8{"Re" ital "verb"} }  \( φ \) } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id9887450">Therefore, the signal to interference ratio becomes</para>
        <para id="id11639199">
          <m:math>
            <m:semantics>
              <m:mrow>
                <m:mstyle fontsize="12pt">
                  <m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:msub>
                            <m:mtext>SIR</m:mtext>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mstyle fontstyle="italic">
                                  <m:mrow>
                                    <m:mtext>DSW</m:mtext>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mi>,</m:mi>
                      <m:mi>φ</m:mi>
                      <m:mrow>
                        <m:mo stretchy="false">)</m:mo>
                        <m:mo stretchy="false">=</m:mo>
                        <m:mfrac>
                          <m:mrow>
                            <m:msup>
                              <m:mi>S</m:mi>
                              <m:mtext>Target</m:mtext>
                            </m:msup>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">(</m:mo>
                                  <m:msub>
                                    <m:mi>t</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mi>,</m:mi>
                                  <m:msub>
                                    <m:mi>φ</m:mi>
                                    <m:mn>0</m:mn>
                                  </m:msub>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                            <m:mstyle fontsize="12pt">
                              <m:mrow>
                                <m:mrow>
                                  <m:mo stretchy="false">)</m:mo>
                                  <m:msup>
                                    <m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                      <m:mrow>
                                        <m:mi>χ</m:mi>
                                        <m:mo stretchy="false">(</m:mo>
                                        <m:mrow>
                                          <m:mi>t</m:mi>
                                          <m:mo stretchy="false">−</m:mo>
                                          <m:msub>
                                            <m:mi>t</m:mi>
                                            <m:mn>0</m:mn>
                                          </m:msub>
                                        </m:mrow>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mrow>
                                              <m:mi>,</m:mi>
                                              <m:mrow>
                                                <m:mi>φ</m:mi>
                                                <m:mo stretchy="false">−</m:mo>
                                                <m:msub>
                                                  <m:mi>φ</m:mi>
                                                  <m:mn>0</m:mn>
                                                </m:msub>
                                              </m:mrow>
                                            </m:mrow>
                                          </m:mrow>
                                        </m:mstyle>
                                        <m:mstyle fontsize="12pt">
                                          <m:mrow>
                                            <m:mo stretchy="false">)</m:mo>
                                          </m:mrow>
                                        </m:mstyle>
                                      </m:mrow>
                                      <m:mo stretchy="false">∣</m:mo>
                                    </m:mrow>
                                    <m:mn>2</m:mn>
                                  </m:msup>
                                </m:mrow>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                          <m:mstyle fontsize="12pt">
                            <m:mrow>
                              <m:mrow>
                                <m:msub>
                                  <m:mi>R</m:mi>
                                  <m:msub>
                                    <m:mrow/>
                                    <m:mstyle fontsize="6pt">
                                      <m:mrow>
                                        <m:msub>
                                          <m:mi>t</m:mi>
                                          <m:mn>0</m:mn>
                                        </m:msub>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:msub>
                                </m:msub>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:msub>
                                      <m:mi>Q</m:mi>
                                      <m:mtext>Reverb</m:mtext>
                                    </m:msub>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mstyle fontsize="12pt">
                                  <m:mrow>
                                    <m:mrow>
                                      <m:mo stretchy="false">(</m:mo>
                                      <m:mi>φ</m:mi>
                                      <m:mrow>
                                        <m:mo stretchy="false">)</m:mo>
                                        <m:mo stretchy="false">+</m:mo>
                                        <m:mfrac>
                                          <m:mstyle fontstyle="italic">
                                            <m:mrow>
                                              <m:msub>
                                                <m:mtext>AN</m:mtext>
                                                <m:mn>0</m:mn>
                                              </m:msub>
                                            </m:mrow>
                                          </m:mstyle>
                                          <m:mstyle fontsize="12pt">
                                            <m:mrow>
                                              <m:msub>
                                                <m:mi>E</m:mi>
                                                <m:mi>T</m:mi>
                                              </m:msub>
                                            </m:mrow>
                                          </m:mstyle>
                                        </m:mfrac>
                                      </m:mrow>
                                    </m:mrow>
                                  </m:mrow>
                                </m:mstyle>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:mfrac>
                      </m:mrow>
                    </m:mrow>
                  </m:mrow>
                </m:mstyle>
                <m:mrow/>
              </m:mrow>
              <m:annotation encoding="StarMath 5.0"> size 12{ ital "SIR" rSub { size 8{ ital "DSW"} }  \( t,φ \) = {  {S rSup {"Target"}  size 12{ \( t rSub {0} } size 12{,φ rSub {0} } size 12{ \)  lline χ \( t - t rSub {0}  size 12{,φ - φ rSub {0} } size 12{ \) } rline  rSup {2} }}  over  { size 12{R rSub { {} rSub { size 6{t rSub {0} } } }  size 12{Q rSub {"Reverb"} } size 12{ \( φ \) + {  { ital "AN" rSub {0} }  over  { size 12{E rSub {T} } } } }} } } } {}</m:annotation>
            </m:semantics>
          </m:math>
        </para>
        <para id="id11149068">We see that the best waveform for enhancing signal to interference ratio depends on the environmental Q function, and the assumed target Doppler. </para>
      </section>
    </section>
    <section id="id-126156431676">
      <title>The Active Sonar Equation</title>
      <para id="id12146099">The active sonar equation expresses the signal excess (SE) which is the part of the target signal to noise ratio that exceeds the sonar’s detection threshold (DT). In decibel quantities, it is given by:</para>
      <para id="id12146103">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>SE</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mrow>
                        <m:mrow>
                          <m:mrow>
                            <m:mrow>
                              <m:mstyle fontstyle="italic">
                                <m:mrow>
                                  <m:mtext>ESL</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                              <m:mo stretchy="false">+</m:mo>
                              <m:mstyle fontstyle="italic">
                                <m:mrow>
                                  <m:mtext>TS</m:mtext>
                                </m:mrow>
                              </m:mstyle>
                            </m:mrow>
                            <m:mo stretchy="false">−</m:mo>
                            <m:mstyle fontstyle="italic">
                              <m:mrow>
                                <m:msub>
                                  <m:mtext>TL</m:mtext>
                                  <m:mstyle fontsize="8pt">
                                    <m:mrow>
                                      <m:mstyle fontstyle="italic">
                                        <m:mrow>
                                          <m:mtext>ST</m:mtext>
                                        </m:mrow>
                                      </m:mstyle>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msub>
                              </m:mrow>
                            </m:mstyle>
                          </m:mrow>
                          <m:mo stretchy="false">−</m:mo>
                          <m:mstyle fontstyle="italic">
                            <m:mrow>
                              <m:msub>
                                <m:mtext>TL</m:mtext>
                                <m:mstyle fontsize="8pt">
                                  <m:mrow>
                                    <m:mstyle fontstyle="italic">
                                      <m:mrow>
                                        <m:mtext>TR</m:mtext>
                                      </m:mrow>
                                    </m:mstyle>
                                  </m:mrow>
                                </m:mstyle>
                              </m:msub>
                            </m:mrow>
                          </m:mstyle>
                        </m:mrow>
                        <m:mo stretchy="false">−</m:mo>
                        <m:mo stretchy="false">(</m:mo>
                      </m:mrow>
                    </m:mrow>
                    <m:mstyle fontstyle="italic">
                      <m:mrow>
                        <m:msub>
                          <m:mtext>RL</m:mtext>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>0</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                    </m:mstyle>
                    <m:mi>⊕</m:mi>
                    <m:mstyle fontstyle="italic">
                      <m:mrow>
                        <m:msub>
                          <m:mtext>AN</m:mtext>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>0</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                    </m:mstyle>
                    <m:mrow>
                      <m:mo stretchy="false">)</m:mo>
                      <m:mo stretchy="false">−</m:mo>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:mtext>DT</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                    </m:mrow>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{ ital "SE"= ital "ESL"+ ital "TS" -  ital "TL" rSub { size 8{ ital "ST"} }  -  ital "TL" rSub { size 8{ ital "TR"} }  -  \(  ital "RL" rSub { size 8{0} } ⊕ ital "AN" rSub { size 8{0} }  \)  -  ital "DT"} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11161184">We are assuming that the active sonar uses a matched filter for detection. In the sonar equation, the transmitted energy signal level (ESL) is the sound pressure squared and integrated over the transmitted pulse length. The energy of the received echo (known as the echo energy level) is
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mtext>10</m:mtext><m:mtext>*log</m:mtext><m:mtext>10</m:mtext><m:mo stretchy="false">(</m:mo><m:msub><m:mi>E</m:mi><m:mstyle fontsize="8pt"><m:mrow><m:mi>R</m:mi></m:mrow></m:mstyle></m:msub><m:mrow><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">=</m:mo><m:mrow><m:mrow><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>ESL</m:mtext></m:mrow></m:mstyle><m:mo stretchy="false">+</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:mtext>TS</m:mtext></m:mrow></m:mstyle></m:mrow><m:mo stretchy="false">−</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>TL</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>ST</m:mtext></m:mrow></m:mstyle></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow><m:mo stretchy="false">−</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>TL</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>TR</m:mtext></m:mrow></m:mstyle></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mrow></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{"10""*log""10" \( E rSub { size 8{R} }  \) = ital "ESL"+ ital "TS" -  ital "TL" rSub { size 8{ ital "ST"} }  -  ital "TL" rSub { size 8{ ital "TR"} } } {}</m:annotation></m:semantics></m:math>. Note that the echo energy level can be computed using a received echo pulse length, which due to sound channel dispersion can be longer than the transmitted pulse.</para>
      <para id="id10997980">Using the properties of matched filters, the matched filter generates an output due to the target echo with peak power level of
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mrow><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>ESL</m:mtext></m:mrow></m:mstyle><m:mo stretchy="false">+</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:mtext>TS</m:mtext></m:mrow></m:mstyle></m:mrow><m:mo stretchy="false">−</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>TL</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>ST</m:mtext></m:mrow></m:mstyle></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow><m:mo stretchy="false">−</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>TL</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:mtext>TR</m:mtext></m:mrow></m:mstyle></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "ESL"+ ital "TS" -  ital "TL" rSub { size 8{ ital "ST"} }  -  ital "TL" rSub { size 8{ ital "TR"} } } {}</m:annotation></m:semantics></m:math>.</para>
      <para id="id12115463"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>is the ambient noise level in a 1 Hz band, and is assumed to be constant across the matched filter’s bandwidth, e.g. it is twice the spectral density of the ambient noise. 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math> and spectral density have units of 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msup><m:mtext>Pa</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>2</m:mn></m:mrow></m:mstyle></m:msup></m:mrow></m:mstyle><m:mo stretchy="false">/</m:mo><m:mstyle fontstyle="italic"><m:mrow><m:mtext>Hz</m:mtext></m:mrow></m:mstyle></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "Pa" rSup { size 8{2} } / ital "Hz"} {}</m:annotation></m:semantics></m:math>, which is an energy quantity. </para>
      <para id="id11135745">The matched filter noise output is
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>RL</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle><m:mi>⊕</m:mi><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>AN</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "RL" rSub { size 8{0} } ⊕ ital "AN" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>. The operation 
<m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mi>⊕</m:mi></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{⊕} {}</m:annotation></m:semantics></m:math> corresponds to power addition. Power addition converts the quantities back to units of power (Pa^2, volts^2, etc), adds the two power like quantities, and then reconverts back into decibel. </para>
      <para id="id12141807">
        <m:math>
          <m:semantics>
            <m:mrow>
              <m:mstyle fontsize="12pt">
                <m:mrow>
                  <m:mrow>
                    <m:mstyle fontstyle="italic">
                      <m:mrow>
                        <m:msub>
                          <m:mtext>RL</m:mtext>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mn>0</m:mn>
                            </m:mrow>
                          </m:mstyle>
                        </m:msub>
                      </m:mrow>
                    </m:mstyle>
                    <m:mi>⊕</m:mi>
                    <m:mrow>
                      <m:mstyle fontstyle="italic">
                        <m:mrow>
                          <m:msub>
                            <m:mtext>AN</m:mtext>
                            <m:mstyle fontsize="8pt">
                              <m:mrow>
                                <m:mn>0</m:mn>
                              </m:mrow>
                            </m:mstyle>
                          </m:msub>
                        </m:mrow>
                      </m:mstyle>
                      <m:mo stretchy="false">=</m:mo>
                      <m:mtext>10</m:mtext>
                    </m:mrow>
                    <m:msub>
                      <m:mtext>log</m:mtext>
                      <m:mstyle fontsize="8pt">
                        <m:mrow>
                          <m:mtext>10</m:mtext>
                        </m:mrow>
                      </m:mstyle>
                    </m:msub>
                    <m:mfenced open="" close="">
                      <m:mrow>
                        <m:msup>
                          <m:mtext>10</m:mtext>
                          <m:mstyle fontsize="8pt">
                            <m:mrow>
                              <m:mrow>
                                <m:mstyle fontstyle="italic">
                                  <m:mrow>
                                    <m:msub>
                                      <m:mtext>RL</m:mtext>
                                      <m:mstyle fontsize="6pt">
                                        <m:mrow>
                                          <m:mn>0</m:mn>
                                        </m:mrow>
                                      </m:mstyle>
                                    </m:msub>
                                  </m:mrow>
                                </m:mstyle>
                                <m:mo stretchy="false">/</m:mo>
                                <m:mtext>10</m:mtext>
                              </m:mrow>
                            </m:mrow>
                          </m:mstyle>
                        </m:msup>
                        <m:mo stretchy="false">+</m:mo>
                        <m:msup>
                          <m:mtext>10</m:mtext>
                          <m:mrow>
                            <m:mstyle fontstyle="italic">
                              <m:mrow>
                                <m:msub>
                                  <m:mtext>AN</m:mtext>
                                  <m:mstyle fontsize="6pt">
                                    <m:mrow>
                                      <m:mn>0</m:mn>
                                    </m:mrow>
                                  </m:mstyle>
                                </m:msub>
                              </m:mrow>
                            </m:mstyle>
                            <m:mo stretchy="false">/</m:mo>
                            <m:mtext>10</m:mtext>
                          </m:mrow>
                        </m:msup>
                      </m:mrow>
                    </m:mfenced>
                  </m:mrow>
                </m:mrow>
              </m:mstyle>
              <m:mrow/>
            </m:mrow>
            <m:annotation encoding="StarMath 5.0"> size 12{ ital "RL" rSub { size 8{0} } ⊕ ital "AN" rSub { size 8{0} } ="10""log" rSub { size 8{"10"} }  left ("10" rSup { size 8{ ital "RL" rSub { size 6{0} } /"10"} } +"10" rSup { ital "AN" rSub { size 6{0} } /"10"}  right )} {}</m:annotation>
          </m:semantics>
        </m:math>
      </para>
      <para id="id11885031"><m:math><m:semantics><m:mrow><m:mstyle fontsize="12pt"><m:mrow><m:mstyle fontstyle="italic"><m:mrow><m:msub><m:mtext>RL</m:mtext><m:mstyle fontsize="8pt"><m:mrow><m:mn>0</m:mn></m:mrow></m:mstyle></m:msub></m:mrow></m:mstyle></m:mrow></m:mstyle><m:mrow/></m:mrow><m:annotation encoding="StarMath 5.0"> size 12{ ital "RL" rSub { size 8{0} } } {}</m:annotation></m:semantics></m:math>is the reverberation level in a 1 Hz band, or equivalently, the reverberation level when measured at the output of the matched filter. </para>
    </section>
  </content>
</document>